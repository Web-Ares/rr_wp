"use strict";!function(){$(function(){$.each($(".learn-more"),function(){new n($(this))}),$.each($(".site__anchors"),function(){new t($(this))})});var n=function(n){var t=this,o=n,i=$("html, body"),c=o,e=function(){c.on({click:function(){return a($(this)),!1}})},a=function(n){var t=n,o=t.parents('[data-more="true"]'),c=o.next(),e=c.offset().top;i.animate({scrollTop:e},300)},f=function(){o[0].obj=t,e()};f()},t=function(n){var t=this,o=n,i=$("html, body"),c=$(window),e=$('[data-anchor="true"]'),a=function(){o.find("a").on({click:function(){return r($(this)),!1}}),c.on({scroll:function(){f()}})},f=function(){var n=c.scrollTop();e.each(function(){var t=$(this),i=t.index(),e=t.offset().top;n+c.height()/2>=e&&t.innerHeight()+e>=n+c.height()/2&&(o.find("a").removeClass("active"),o.find("a").eq(i).addClass("active"))})},r=function(n){var t=n,o=t.index(),c=e.eq(o),a=c.offset().top;i.animate({scrollTop:a},300)},s=function(){o[0].obj=t,a(),f()};s()}}();
"use strict";!function(){$(function(){$.each($(".clouds"),function(){new t($(this))}),$.each($(".guy"),function(){new n($(this))}),$.each($(".site__content_full"),function(){new i($(this))}),$.each($(".plans"),function(){new s($(this))})});var t=function(t){var n=this,i=t,s=i,o=$(window),a=(o.width(),function(){o.on({resize:function(){h(),e()},load:function(){e()},scroll:function(){e()}})}),e=function(){var t,n=i.offset().top,s=n-o.height(),a=n+i.height(),e=(a-o.scrollTop())/(a-s);e>1?t=0:e<0&&(t=1),e<1&&e>0&&(t=1-e),i.hasClass("putted-all")&&(t=.5),r(s,a,t)},r=function(t,n,i){s.each(function(){var t=$(this),n=100,s=1;t.hasClass("clouds_1")&&(s=-1),0==i?t.css({"-webkit-transform":"translateX("+-n*s+"%)",transform:"translateX("+-n*s+"%)"}):1==i?t.css({"-webkit-transform":"translateX("+-n*s+"%)",transform:"translateX("+-n*s+"%)"}):(i>=.5&&(i=1-i),t.css({"-webkit-transform":"translateX("+200*i*s+"%)",transform:"translateX("+200*i*s+"%)"}))})},h=function(){var t=o.height(),n=$(".site").height();n<=t?i.addClass("putted-all"):i.removeClass("putted-all")},f=function(){i[0].obj=n,a(),h()};f()},n=function(t){var n=this,i=t,s=i.find(".guy__hand"),o=$(window),a=o.width(),e=function(){o.on({resize:function(){a!=o.width()&&(a=o.width()+1,o.width()<768&&s.css({"-webkit-transform":"none",transform:"none"})),f(),h(),r()},load:function(){o.width()>=768&&r()},scroll:function(){o.width()>=768&&r()}})},r=function(){var t,n=o.height(),a=i.offset().top,e=s.offset().top-n,r=a-n+i.height();i.hasClass("putted")&&(e=s.offset().top-n/2,r=n/2.5);var h=(r-o.scrollTop())/(r-e);h>1?t=0:h<0&&(t=1),h<1&&h>0&&(t=1-h),i.hasClass("putted-all")&&(t=1),c(e,r,t)},h=function(){var t=o.height(),n=o.scrollTop(),a=s.height(),e=s.offset().top;a+e<t+n&&$(".site").height()>2*t?i.addClass("putted"):i.removeClass("putted")},f=function(){var t=o.height(),n=$(".site").height();n<=t?i.addClass("putted-all"):i.removeClass("putted-all")},c=function(t,n,i){var a=n-t;s.each(function(){var n=$(this),s=n.data("rotate-start"),e=n.data("rotate-finish"),r=s+(e-s)/a*(o.scrollTop()-t);1==i?n.css({"-webkit-transform":"rotate( "+-e+"deg )",transform:"rotate( "+-e+"deg )"}):0==i?n.css({"-webkit-transform":"rotate( "+-s+"deg )",transform:"rotate( "+-s+"deg )"}):n.css({"-webkit-transform":"rotate( "+-r+"deg )",transform:"rotate( "+-r+"deg )"})})},u=function(){i[0].obj=n,e(),h(),f()};u()},i=function(t){var n=this,i=t,s=$(window),o=$(".site__header"),a=function(){s.on({resize:function(){e()}})},e=function(){var t=o.height();i.height(s.height()-t),i.css({"min-height":i.find(">div:first").height()})},r=function(){i[0].obj=n,a(),e()};r()},s=function(t){var n=this,i=t,s=$(window),o=i.find(".plans__list_caption"),a=i.find(".plans__list-row:not(.plans__list_caption)"),e=[],r=[],h=function(){s.on({load:function(){s.width()>=768&&f()},resize:function(){s.width()<768?(o.css({height:""}),a.css({height:""})):f()}})},f=function(){e=[],r=[],o.each(function(){var t=$(this).innerHeight();e.push(t)});var t=Math.max.apply(Math,e);a.each(function(){var t=$(this).innerHeight();r.push(t)});var n=Math.max.apply(Math,r);o.innerHeight(t),a.innerHeight(n)},c=function(){i[0].obj=n,h()};c()}}();
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImpxdWVyeS5pbmRleC5qcyIsImpxdWVyeS5tYWluLmpzIl0sIm5hbWVzIjpbIiQiLCJlYWNoIiwiU2Nyb2xsRG93biIsInRoaXMiLCJBbmNob3JzIiwib2JqIiwiX3NlbGYiLCJfb2JqIiwiX2RvbSIsIl9idG5MZWFybk1vcmUiLCJfYWRkRXZlbnRzIiwib24iLCJjbGljayIsIl9maW5kTmVlZEJsb2NrIiwiYnRuIiwiY2xpY2tCdG4iLCJwYXJlbnRCbG9jayIsInBhcmVudHMiLCJuZXh0QmxvY2siLCJuZXh0IiwibmV4dEJsb2NrUG9zaXRpb24iLCJvZmZzZXQiLCJ0b3AiLCJhbmltYXRlIiwic2Nyb2xsVG9wIiwiX2luaXQiLCJfd2luZG93Iiwid2luZG93IiwiX2l0ZW1zIiwiZmluZCIsInNjcm9sbCIsIl9jaGFuZ2VBY3RpdmVBbmNob3JzIiwiY3VyRWxlbSIsImN1ckVsZW1JbmRleCIsImluZGV4IiwiY3VyRWxlbVBvcyIsImhlaWdodCIsImlubmVySGVpZ2h0IiwicmVtb3ZlQ2xhc3MiLCJlcSIsImFkZENsYXNzIiwibmVlZEJsb2NrIiwibmVlZEJsb2NrUG9zaXRpb24iLCJDbG91ZHNBbmltYXRlZCIsIkd1eUFuaW1hdGVkIiwiQ29udGVudEZ1bGxIZWlnaHQiLCJQbGFuc0Nob29zZUhlaWdodCIsIndpZHRoIiwicmVzaXplIiwiX2NoZWNrUHV0SW5XaW5kb3ciLCJfY2hlY2tTY3JvbGwiLCJsb2FkIiwic2Nyb2xsUG9pbnQiLCJ0b3BQb3MiLCJzdGFydCIsImVuZCIsIngiLCJoYXNDbGFzcyIsIl9hbmltYXRpb25FbGVtcyIsInN0YXJ0UG9pbnQiLCJlbmRQb2ludCIsInRyYW5zbGF0ZUZpbmlzaCIsImNzcyIsIi13ZWJraXQtdHJhbnNmb3JtIiwidHJhbnNmb3JtIiwiaGVpZ2h0V2luIiwiaGVpZ2h0U2l0ZSIsIl9oYW5kIiwiX2dsb2JhbFdpZHRoIiwiX2NoZWNrR2V0SW5XaW5kb3ciLCJ3aW5kb3dIIiwic2Nyb2xsVG9wV2luIiwiaGVpZ2h0T2JqIiwicG9zaXRpb25PYmoiLCJzZWdtZW50Iiwicm90YXRlU3RhcnQiLCJkYXRhIiwicm90YXRlRmluaXNoIiwia29mUm90YXRlIiwiX2hlYWRlciIsIl9zZXRIZWlnaHQiLCJoZWFkZXJIZWlndGgiLCJtaW4taGVpZ2h0IiwiX2NhcHRpb24iLCJfY29udGVudCIsIl9jYXB0aW9uSGVpZ2h0cyIsIl9jb250ZW50SGVpZ2h0cyIsInB1c2giLCJtYXhIZWlnaHRDYXB0aW9uIiwiTWF0aCIsIm1heCIsImFwcGx5IiwibWF4SGVpZ2h0Q29udGVudCJdLCJtYXBwaW5ncyI6IkFBQUEsY0FDQSxXQUVJQSxFQUFHLFdBRUNBLEVBQUVDLEtBQU1ELEVBQUUsZUFBZ0IsV0FFdEIsR0FBSUUsR0FBWUYsRUFBRUcsU0FJdEJILEVBQUVDLEtBQU1ELEVBQUUsa0JBQW1CLFdBRXpCLEdBQUlJLEdBQVNKLEVBQUVHLFVBTXZCLElBQUlELEdBQWEsU0FBV0csR0FFeEIsR0FBSUMsR0FBUUgsS0FDUkksRUFBT0YsRUFDUEcsRUFBT1IsRUFBRyxjQUNWUyxFQUFnQkYsRUFFaEJHLEVBQWEsV0FFVEQsRUFBY0UsSUFDVkMsTUFBTyxXQUlILE1BRkFDLEdBQWdCYixFQUFFRyxRQUVYLE1BS25CVSxFQUFpQixTQUFVQyxHQUV2QixHQUFJQyxHQUFXRCxFQUNYRSxFQUFjRCxFQUFTRSxRQUFRLHNCQUMvQkMsRUFBWUYsRUFBWUcsT0FDeEJDLEVBQW9CRixFQUFVRyxTQUFTQyxHQUUzQ2QsR0FBS2UsU0FBV0MsVUFBV0osR0FBcUIsTUFJcERLLEVBQVEsV0FDSmxCLEVBQUssR0FBR0YsSUFBTUMsRUFDZEksSUFHUmUsTUFHQXJCLEVBQVUsU0FBV0MsR0FFckIsR0FBSUMsR0FBUUgsS0FDUkksRUFBT0YsRUFDUEcsRUFBT1IsRUFBRyxjQUNWMEIsRUFBVTFCLEVBQUUyQixRQUNaQyxFQUFVNUIsRUFBRSx3QkFFWlUsRUFBYSxXQUVUSCxFQUFLc0IsS0FBSyxLQUFLbEIsSUFDWEMsTUFBTyxXQUlILE1BRkFDLEdBQWdCYixFQUFF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aEMxRSxFQUFLdUQsS0FDRG9CLGFBQWMzRSxFQUFLc0IsS0FBSyxjQUFjTyxZQUc5Q1gsRUFBUSxXQUNKbEIsRUFBSyxHQUFHRixJQUFNQyxFQUNkSSxJQUNBc0UsSUFHUnZELE1BR0FxQixFQUFvQixTQUFXekMsR0FFL0IsR0FBSUMsR0FBUUgsS0FDUkksRUFBT0YsRUFDUHFCLEVBQVUxQixFQUFFMkIsUUFDWndELEVBQVc1RSxFQUFLc0IsS0FBSyx3QkFDckJ1RCxFQUFXN0UsRUFBS3NCLEtBQUssOENBQ3JCd0QsS0FDQUMsS0FFQTVFLEVBQWEsV0FFVGdCLEVBQVFmLElBQ0p3QyxLQUFNLFdBRUV6QixFQUFRcUIsU0FBVyxLQUVuQmlDLEtBS1JoQyxPQUFRLFdBRUF0QixFQUFRcUIsUUFBVSxLQUVsQm9DLEVBQVNyQixLQUNMMUIsT0FBUSxLQUVaZ0QsRUFBU3RCLEtBQ0wxQixPQUFRLE1BS1o0QyxRQVFoQkEsRUFBYSxXQUNUSyxLQUNBQyxLQUVBSCxFQUFTbEYsS0FBTSxXQUVYLEdBQUltQyxHQUFTcEMsRUFBRUcsTUFBTWtDLGFBRXJCZ0QsR0FBZ0JFLEtBQU1uRCxJQUkxQixJQUFJb0QsR0FBbUJDLEtBQUtDLElBQUlDLE1BQU1GLEtBQU1KLEVBRzVDRCxHQUFTbkYsS0FBTSxXQUVYLEdBQUltQyxHQUFTcEMsRUFBRUcsTUFBTWtDLGFBRXJCaUQsR0FBZ0JDLEtBQU1uRCxJQUkxQixJQUFJd0QsR0FBbUJILEtBQUtDLElBQUlDLE1BQU1GLEtBQU1ILEVBRTVDSCxHQUFTOUMsWUFBYW1ELEdBQ3RCSixFQUFTL0MsWUFBYXVELElBRzFCbkUsRUFBUSxXQUNKbEIsRUFBSyxHQUFHRixJQUFNQyxFQUNkSSxJQUdSZSIsImZpbGUiOiJpbmRleC5taW4uanMiLCJzb3VyY2VzQ29udGVudCI6WyJcInVzZSBzdHJpY3RcIjtcbiggZnVuY3Rpb24oKSB7XG5cbiAgICAkKCBmdW5jdGlvbigpIHtcblxuICAgICAgICAkLmVhY2goICQoJy5sZWFybi1tb3JlJyksIGZ1bmN0aW9uICgpIHtcblxuICAgICAgICAgICAgbmV3IFNjcm9sbERvd24oICQodGhpcykgKTtcblxuICAgICAgICB9ICk7XG5cbiAgICAgICAgJC5lYWNoKCAkKCcuc2l0ZV9fYW5jaG9ycycpLCBmdW5jdGlvbiAoKSB7XG5cbiAgICAgICAgICAgIG5ldyBBbmNob3JzKCAkKHRoaXMpICk7XG5cbiAgICAgICAgfSApO1xuXG4gICAgfSApO1xuXG4gICAgdmFyIFNjcm9sbERvd24gPSBmdW5jdGlvbiAoIG9iaiApIHtcblxuICAgICAgICB2YXIgX3NlbGYgPSB0aGlzLFxuICAgICAgICAgICAgX29iaiA9IG9iaixcbiAgICAgICAgICAgIF9kb20gPSAkKCAnaHRtbCwgYm9keScgKSxcbiAgICAgICAgICAgIF9idG5MZWFybk1vcmUgPSBfb2JqO1xuXG4gICAgICAgIHZhciBfYWRkRXZlbnRzID0gZnVuY3Rpb24gKCkge1xuXG4gICAgICAgICAgICAgICAgX2J0bkxlYXJuTW9yZS5vbigge1xuICAgICAgICAgICAgICAgICAgICBjbGljazogZnVuY3Rpb24oKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIF9maW5kTmVlZEJsb2NrKCAkKHRoaXMpICk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0gKTtcblxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIF9maW5kTmVlZEJsb2NrID0gZnVuY3Rpb24oIGJ0biApIHtcblxuICAgICAgICAgICAgICAgIHZhciBjbGlja0J0biA9IGJ0bixcbiAgICAgICAgICAgICAgICAgICAgcGFyZW50QmxvY2sgPSBjbGlja0J0bi5wYXJlbnRzKCdbZGF0YS1tb3JlPVwidHJ1ZVwiXScpLFxuICAgICAgICAgICAgICAgICAgICBuZXh0QmxvY2sgPSBwYXJlbnRCbG9jay5uZXh0KCksXG4gICAgICAgICAgICAgICAgICAgIG5leHRCbG9ja1Bvc2l0aW9uID0gbmV4dEJsb2NrLm9mZnNldCgpLnRvcDtcblxuICAgICAgICAgICAgICAgIF9kb20uYW5pbWF0ZSggeyBzY3JvbGxUb3A6IG5leHRCbG9ja1Bvc2l0aW9uIH0sIDMwMCApO1xuXG5cbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBfaW5pdCA9IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgIF9vYmpbMF0ub2JqID0gX3NlbGY7XG4gICAgICAgICAgICAgICAgX2FkZEV2ZW50cygpO1xuICAgICAgICAgICAgfTtcblxuICAgICAgICBfaW5pdCgpO1xuICAgIH07XG5cbiAgICB2YXIgQW5jaG9ycyA9IGZ1bmN0aW9uICggb2JqICkge1xuXG4gICAgICAgIHZhciBfc2VsZiA9IHRoaXMsXG4gICAgICAgICAgICBfb2JqID0gb2JqLFxuICAgICAgICAgICAgX2RvbSA9ICQoICdodG1sLCBib2R5JyApLFxuICAgICAgICAgICAgX3dpbmRvdyA9ICQod2luZG93KSxcbiAgICAgICAgICAgIF9pdGVtcyAgPSAkKCdbZGF0YS1hbmNob3I9XCJ0cnVlXCJdJyk7XG5cbiAgICAgICAgdmFyIF9hZGRFdmVudHMgPSBmdW5jdGlvbiAoKSB7XG5cbiAgICAgICAgICAgICAgICBfb2JqLmZpbmQoJ2EnKS5vbigge1xuICAgICAgICAgICAgICAgICAgICBjbGljazogZnVuY3Rpb24oKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIF9maW5kTmVlZEJsb2NrKCAkKHRoaXMpICk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0gKTtcblxuICAgICAgICAgICAgICAgIF93aW5kb3cub24oIHtcbiAgICAgICAgICAgICAgICAgICAgc2Nyb2xsOiBmdW5jdGlvbigpIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgX2NoYW5nZUFjdGl2ZUFuY2hvcnMoKTtcblxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSApO1xuXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgX2NoYW5nZUFjdGl2ZUFuY2hvcnMgPSBmdW5jdGlvbigpIHtcblxuICAgICAgICAgICAgICAgIHZhciBzY3JvbGxUb3AgPSBfd2luZG93LnNjcm9sbFRvcCgpO1xuXG4gICAgICAgICAgICAgICAgX2l0ZW1zLmVhY2goIGZ1bmN0aW9uKCkge1xuXG4gICAgICAgICAgICAgICAgICAgIHZhciBjdXJFbGVtID0gJCh0aGlzKSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGN1ckVsZW1JbmRleCA9IGN1ckVsZW0uaW5kZXgoKSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGN1ckVsZW1Qb3MgPSBjdXJFbGVtLm9mZnNldCgpLnRvcDtcblxuICAgICAgICAgICAgICAgICAgICBpZiggKCAoIHNjcm9sbFRvcCArIF93aW5kb3cuaGVpZ2h0KCkvMiApID49IGN1ckVsZW1Qb3MgKSAmJiAoICggY3VyRWxlbS5pbm5lckhlaWdodCgpICsgY3VyRWxlbVBvcyApID49IHNjcm9sbFRvcCArIF93aW5kb3cuaGVpZ2h0KCkvMiApICApIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgX29iai5maW5kKCdhJykucmVtb3ZlQ2xhc3MoJ2FjdGl2ZScpO1xuICAgICAgICAgICAgICAgICAgICAgICAgX29iai5maW5kKCdhJykuZXEoY3VyRWxlbUluZGV4KS5hZGRDbGFzcygnYWN0aXZlJyk7XG5cbiAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgfSApO1xuXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgX2ZpbmROZWVkQmxvY2sgPSBmdW5jdGlvbiggYnRuICkge1xuXG4gICAgICAgICAgICAgICAgdmFyIGNsaWNrQnRuID0gYnRuLFxuICAgICAgICAgICAgICAgICAgICBpbmRleCA9IGNsaWNrQnRuLmluZGV4KCksXG4gICAgICAgICAgICAgICAgICAgIG5lZWRCbG9jayA9IF9pdGVtcy5lcShpbmRleCksXG4gICAgICAgICAgICAgICAgICAgIG5lZWRCbG9ja1Bvc2l0aW9uID0gbmVlZEJsb2NrLm9mZnNldCgpLnRvcDtcblxuICAgICAgICAgICAgICAgIF9kb20uYW5pbWF0ZSggeyBzY3JvbGxUb3A6IG5lZWRCbG9ja1Bvc2l0aW9uIH0sIDMwMCApO1xuXG5cbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBfaW5pdCA9IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgIF9vYmpbMF0ub2JqID0gX3NlbGY7XG4gICAgICAgICAgICAgICAgX2FkZEV2ZW50cygpO1xuICAgICAgICAgICAgICAgIF9jaGFuZ2VBY3RpdmVBbmNob3JzKCk7XG4gICAgICAgICAgICB9O1xuXG4gICAgICAgIF9pbml0KCk7XG4gICAgfTtcblxufSApKCk7XG4iLCJcInVzZSBzdHJpY3RcIjtcbiggZnVuY3Rpb24oKSB7XG5cbiAgICAkKCBmdW5jdGlvbigpIHtcblxuICAgICAgICAkLmVhY2goICQoJy5jbG91ZHMnKSwgZnVuY3Rpb24gKCkge1xuXG4gICAgICAgICAgICBuZXcgQ2xvdWRzQW5pbWF0ZWQoICQodGhpcykgKTtcblxuICAgICAgICB9ICk7XG5cbiAgICAgICAgJC5lYWNoKCAkKCcuZ3V5JyksIGZ1bmN0aW9uICgpIHtcblxuICAgICAgICAgICAgbmV3IEd1eUFuaW1hdGVkKCAkKHRoaXMpICk7XG5cbiAgICAgICAgfSApO1xuXG4gICAgICAgICQuZWFjaCggJCgnLnNpdGVfX2NvbnRlbnRfZnVsbCcpLCBmdW5jdGlvbiAoKSB7XG5cbiAgICAgICAgICAgIG5ldyBDb250ZW50RnVsbEhlaWdodCggJCh0aGlzKSApO1xuXG4gICAgICAgIH0gKTtcblxuICAgICAgICAkLmVhY2goICQoJy5wbGFucycpLCBmdW5jdGlvbiAoKSB7XG5cbiAgICAgICAgICAgIG5ldyBQbGFuc0Nob29zZUhlaWdodCggJCh0aGlzKSApO1xuXG4gICAgICAgIH0gKTtcblxuICAgIH0gKTtcblxuICAgIHZhciBDbG91ZHNBbmltYXRlZCA9IGZ1bmN0aW9uIChvYmopIHtcblxuICAgICAgICAvL3ByaXZhdGUgcHJvcGVydGllc1xuICAgICAgICB2YXIgX3NlbGYgPSB0aGlzLFxuICAgICAgICAgICAgX29iaiA9IG9iaixcbiAgICAgICAgICAgIF9pdGVtcyA9IF9vYmosXG4gICAgICAgICAgICBfd2luZG93ID0gJCh3aW5kb3cpLFxuICAgICAgICAgICAgX2dsb2JhbFdpZHRoID0gX3dpbmRvdy53aWR0aCgpO1xuXG4gICAgICAgIC8vcHJpdmF0ZSBtZXRob2RzXG4gICAgICAgIHZhciBfYWRkRXZlbnRzID0gZnVuY3Rpb24gKCkge1xuXG4gICAgICAgICAgICAgICAgX3dpbmRvdy5vbigge1xuICAgICAgICAgICAgICAgICAgICByZXNpemU6IGZ1bmN0aW9uKCkge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICBfY2hlY2tQdXRJbldpbmRvdygpO1xuICAgICAgICAgICAgICAgICAgICAgICAgX2NoZWNrU2Nyb2xsKCk7XG5cbiAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgbG9hZDogZnVuY3Rpb24oKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIF9jaGVja1Njcm9sbCgpO1xuXG4gICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgIHNjcm9sbDogZnVuY3Rpb24gKCkge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICBfY2hlY2tTY3JvbGwoKTtcblxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSApO1xuXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgX2NoZWNrU2Nyb2xsID0gZnVuY3Rpb24oKXtcblxuICAgICAgICAgICAgICAgIHZhciB0b3BQb3MgPSBfb2JqLm9mZnNldCgpLnRvcCAsXG4gICAgICAgICAgICAgICAgICAgIHN0YXJ0ID0gdG9wUG9zIC0gX3dpbmRvdy5oZWlnaHQoKSxcbiAgICAgICAgICAgICAgICAgICAgZW5kID0gdG9wUG9zICsgX29iai5oZWlnaHQoKSxcbiAgICAgICAgICAgICAgICAgICAgc2Nyb2xsUG9pbnQ7XG5cbiAgICAgICAgICAgICAgICB2YXIgeCA9ICggZW5kIC0gX3dpbmRvdy5zY3JvbGxUb3AoKSApIC8gKCBlbmQgLSAgc3RhcnQgKTtcblxuICAgICAgICAgICAgICAgIGlmICggeCA+IDEgKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgc2Nyb2xsUG9pbnQgPSAwO1xuXG5cbiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKCB4IDwgMCApIHtcblxuICAgICAgICAgICAgICAgICAgICBzY3JvbGxQb2ludCA9IDE7XG5cbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBpZiggKCB4IDwgMSApICYmICggeCA+IDAgKSApe1xuXG4gICAgICAgICAgICAgICAgICAgIHNjcm9sbFBvaW50ID0gMSAtIHg7XG5cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYoICBfb2JqLmhhc0NsYXNzKCdwdXR0ZWQtYWxsJykgKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgc2Nyb2xsUG9pbnQgPSAwLjU7XG5cbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBfYW5pbWF0aW9uRWxlbXMoIHN0YXJ0LCBlbmQsIHNjcm9sbFBvaW50ICk7XG5cbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBfYW5pbWF0aW9uRWxlbXMgPSBmdW5jdGlvbiAoIHN0YXJ0UG9pbnQsIGVuZFBvaW50LCBzY3JvbGxQb2ludCApIHtcblxuICAgICAgICAgICAgICAgIF9pdGVtcy5lYWNoKCBmdW5jdGlvbiAoKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgdmFyIGN1ckVsZW0gPSAkKCB0aGlzICksXG4gICAgICAgICAgICAgICAgICAgICAgICB0cmFuc2xhdGVTdGFydCA9IDAsXG4gICAgICAgICAgICAgICAgICAgICAgICB0cmFuc2xhdGVGaW5pc2ggPSAxMDAsXG4gICAgICAgICAgICAgICAgICAgICAgICB4ID0gMTtcblxuICAgICAgICAgICAgICAgICAgICBpZiggY3VyRWxlbS5oYXNDbGFzcygnY2xvdWRzXzEnKSApIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgeCA9IC0xO1xuXG4gICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICBpZiAoIHNjcm9sbFBvaW50ID09IDAgKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIGN1ckVsZW0uY3NzKCB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAnLXdlYmtpdC10cmFuc2Zvcm0nOiAndHJhbnNsYXRlWCgnICsoIC10cmFuc2xhdGVGaW5pc2ggKiB4ICkrICclKScsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJ3RyYW5zZm9ybSc6ICd0cmFuc2xhdGVYKCcgKyggLXRyYW5zbGF0ZUZpbmlzaCAqIHggKSsgJyUpJ1xuXG4gICAgICAgICAgICAgICAgICAgICAgICB9ICk7XG5cbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmICggc2Nyb2xsUG9pbnQgPT0gMSApIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgY3VyRWxlbS5jc3MoIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICctd2Via2l0LXRyYW5zZm9ybSc6ICd0cmFuc2xhdGVYKCcgKyggLXRyYW5zbGF0ZUZpbmlzaCAqIHggKSsgJyUpJyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAndHJhbnNmb3JtJzogJ3RyYW5zbGF0ZVgoJyArKCAtdHJhbnNsYXRlRmluaXNoICogeCApKyAnJSknXG5cbiAgICAgICAgICAgICAgICAgICAgICAgIH0gKTtcblxuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuXG5cbiAgICAgICAgICAgICAgICAgICAgICAgIC8vaWYoIHNjcm9sbFBvaW50IDwgMC41ICYmIHNjcm9sbFBvaW50ID4gMCApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyAgICBjdXJFbGVtLmNzcygge1xuICAgICAgICAgICAgICAgICAgICAgICAgLy9cbiAgICAgICAgICAgICAgICAgICAgICAgIC8vICAgICAgICAnLXdlYmtpdC10cmFuc2Zvcm0nOiAndHJhbnNsYXRlWCgnICsoIHNjcm9sbFBvaW50ICogMjAwICogeCApKyAnJSknLFxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gICAgICAgICd0cmFuc2Zvcm0nOiAndHJhbnNsYXRlWCgnICsoIHNjcm9sbFBvaW50ICogMjAwICogeCApKyAnJSknXG4gICAgICAgICAgICAgICAgICAgICAgICAvL1xuICAgICAgICAgICAgICAgICAgICAgICAgLy8gICAgfSApO1xuICAgICAgICAgICAgICAgICAgICAgICAgLy9cbiAgICAgICAgICAgICAgICAgICAgICAgIC8vfVxuICAgICAgICAgICAgICAgICAgICAgICAgLy9cbiAgICAgICAgICAgICAgICAgICAgICAgIC8vXG4gICAgICAgICAgICAgICAgICAgICAgICAvL2lmKCBzY3JvbGxQb2ludCA+PSAwLjUgJiYgc2Nyb2xsUG9pbnQgPCAwLjggKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAvL1xuICAgICAgICAgICAgICAgICAgICAgICAgLy8gICAgY3VyRWxlbS5jc3MoIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyAgICAgICAgJy13ZWJraXQtdHJhbnNmb3JtJzogJ3RyYW5zbGF0ZVgoJyArKCB0cmFuc2xhdGVGaW5pc2ggKiB4ICkrICclKScsXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyAgICAgICAgJ3RyYW5zZm9ybSc6ICd0cmFuc2xhdGVYKCcgKyggdHJhbnNsYXRlRmluaXNoICogeCApKyAnJSknXG4gICAgICAgICAgICAgICAgICAgICAgICAvL1xuICAgICAgICAgICAgICAgICAgICAgICAgLy8gICAgfSApO1xuICAgICAgICAgICAgICAgICAgICAgICAgLy9cbiAgICAgICAgICAgICAgICAgICAgICAgIC8vfVxuICAgICAgICAgICAgICAgICAgICAgICAgLy9cbiAgICAgICAgICAgICAgICAgICAgICAgIC8vaWYoIHNjcm9sbFBvaW50ID49IDAuOCApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyAgICBzY3JvbGxQb2ludCA9IDEuMyAtIHNjcm9sbFBvaW50O1xuICAgICAgICAgICAgICAgICAgICAgICAgLy9cbiAgICAgICAgICAgICAgICAgICAgICAgIC8vICAgIGN1ckVsZW0uY3NzKCB7XG4gICAgICAgICAgICAgICAgICAgICAgICAvL1xuICAgICAgICAgICAgICAgICAgICAgICAgLy8gICAgICAgICctd2Via2l0LXRyYW5zZm9ybSc6ICd0cmFuc2xhdGVYKCcgKyggc2Nyb2xsUG9pbnQgKiAyMDAgKiB4ICkrICclKScsXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyAgICAgICAgJ3RyYW5zZm9ybSc6ICd0cmFuc2xhdGVYKCcgKyggc2Nyb2xsUG9pbnQgKiAyMDAgKiB4ICkrICclKSdcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyAgICB9ICk7XG4gICAgICAgICAgICAgICAgICAgICAgICAvL1xuICAgICAgICAgICAgICAgICAgICAgICAgLy99XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIGlmKCBzY3JvbGxQb2ludCA+PSAwLjUgKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzY3JvbGxQb2ludCA9IDEgLSBzY3JvbGxQb2ludDtcblxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgICAgICBjdXJFbGVtLmNzcygge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJy13ZWJraXQtdHJhbnNmb3JtJzogJ3RyYW5zbGF0ZVgoJyArKCBzY3JvbGxQb2ludCAqIDIwMCAqIHggKSsgJyUpJyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAndHJhbnNmb3JtJzogJ3RyYW5zbGF0ZVgoJyArKCBzY3JvbGxQb2ludCAqIDIwMCAqIHggKSsgJyUpJ1xuXG4gICAgICAgICAgICAgICAgICAgICAgICB9ICk7XG5cblxuICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICB9ICk7XG5cbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBfY2hlY2tQdXRJbldpbmRvdyA9IGZ1bmN0aW9uKCkge1xuXG4gICAgICAgICAgICAgICAgdmFyIGhlaWdodFdpbiA9IF93aW5kb3cuaGVpZ2h0KCksXG4gICAgICAgICAgICAgICAgICAgIGhlaWdodFNpdGUgPSAkKCcuc2l0ZScpLmhlaWdodCgpO1xuXG4gICAgICAgICAgICAgICAgaWYoIGhlaWdodFNpdGUgPD0gaGVpZ2h0V2luICkge1xuXG4gICAgICAgICAgICAgICAgICAgIF9vYmouYWRkQ2xhc3MoJ3B1dHRlZC1hbGwnKTtcblxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG5cbiAgICAgICAgICAgICAgICAgICAgX29iai5yZW1vdmVDbGFzcygncHV0dGVkLWFsbCcpO1xuXG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgX2luaXQgPSBmdW5jdGlvbiAoKSB7XG5cbiAgICAgICAgICAgICAgICBfb2JqWzBdLm9iaiA9IF9zZWxmO1xuICAgICAgICAgICAgICAgIF9hZGRFdmVudHMoKTtcbiAgICAgICAgICAgICAgICBfY2hlY2tQdXRJbldpbmRvdygpO1xuXG4gICAgICAgICAgICB9O1xuXG4gICAgICAgIF9pbml0KCk7XG4gICAgfTtcblxuICAgIHZhciBHdXlBbmltYXRlZCA9IGZ1bmN0aW9uIChvYmopIHtcblxuICAgICAgICAvL3ByaXZhdGUgcHJvcGVydGllc1xuICAgICAgICB2YXIgX3NlbGYgPSB0aGlzLFxuICAgICAgICAgICAgX29iaiA9IG9iaixcbiAgICAgICAgICAgIF9oYW5kID0gX29iai5maW5kKCcuZ3V5X19oYW5kJyksXG4gICAgICAgICAgICBfd2luZG93ID0gJCh3aW5kb3cpLFxuICAgICAgICAgICAgX2dsb2JhbFdpZHRoID0gX3dpbmRvdy53aWR0aCgpO1xuXG4gICAgICAgIC8vcHJpdmF0ZSBtZXRob2RzXG4gICAgICAgIHZhciBfYWRkRXZlbnRzID0gZnVuY3Rpb24gKCkge1xuXG4gICAgICAgICAgICAgICAgX3dpbmRvdy5vbigge1xuICAgICAgICAgICAgICAgICAgICByZXNpemU6IGZ1bmN0aW9uKCkge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiggX2dsb2JhbFdpZHRoICE9IF93aW5kb3cud2lkdGgoKSApIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9nbG9iYWxXaWR0aCA9IF93aW5kb3cud2lkdGgoKSArIDE7XG5cblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmKCBfd2luZG93LndpZHRoKCkgPCA3NjggKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgX2hhbmQuY3NzKCB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnLXdlYmtpdC10cmFuc2Zvcm0nOiAnbm9uZScsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAndHJhbnNmb3JtJzogJ25vbmUnXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gKTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgICAgICBfY2hlY2tQdXRJbldpbmRvdygpO1xuICAgICAgICAgICAgICAgICAgICAgICAgX2NoZWNrR2V0SW5XaW5kb3coKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIF9jaGVja1Njcm9sbCgpO1xuXG4gICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgIGxvYWQ6IGZ1bmN0aW9uKCkge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiggX3dpbmRvdy53aWR0aCgpID49IDc2OCApIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9jaGVja1Njcm9sbCgpO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgc2Nyb2xsOiBmdW5jdGlvbiAoKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChfd2luZG93LndpZHRoKCkgPj0gNzY4KSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBfY2hlY2tTY3JvbGwoKTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9ICk7XG5cbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBfY2hlY2tTY3JvbGwgPSBmdW5jdGlvbigpIHtcblxuICAgICAgICAgICAgICAgIHZhciB3aW5kb3dIID0gX3dpbmRvdy5oZWlnaHQoKSxcbiAgICAgICAgICAgICAgICAgICAgdG9wUG9zID0gX29iai5vZmZzZXQoKS50b3AsXG4gICAgICAgICAgICAgICAgICAgIHN0YXJ0ID0gX2hhbmQub2Zmc2V0KCkudG9wIC0gd2luZG93SCxcbiAgICAgICAgICAgICAgICAgICAgZW5kID0gdG9wUG9zIC0gd2luZG93SCArIF9vYmouaGVpZ2h0KCksXG4gICAgICAgICAgICAgICAgICAgIHNjcm9sbFBvaW50O1xuXG4gICAgICAgICAgICAgICAgaWYoICBfb2JqLmhhc0NsYXNzKCdwdXR0ZWQnKSApIHtcblxuICAgICAgICAgICAgICAgICAgICBzdGFydCA9IF9oYW5kLm9mZnNldCgpLnRvcCAtIHdpbmRvd0gvMjtcbiAgICAgICAgICAgICAgICAgICAgZW5kID0gd2luZG93SC8yLjU7XG5cbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICB2YXIgeCA9ICggZW5kIC0gX3dpbmRvdy5zY3JvbGxUb3AoKSApIC8gKCBlbmQgLSAgc3RhcnQgKTtcblxuICAgICAgICAgICAgICAgIGlmICggeCA+IDEgKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgc2Nyb2xsUG9pbnQgPSAwO1xuXG5cbiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKCB4IDwgMCApIHtcblxuICAgICAgICAgICAgICAgICAgICBzY3JvbGxQb2ludCA9IDE7XG5cbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBpZiggKCB4IDwgMSApICYmICggeCA+IDAgKSApe1xuXG4gICAgICAgICAgICAgICAgICAgIHNjcm9sbFBvaW50ID0gMSAtIHg7XG5cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYoICBfb2JqLmhhc0NsYXNzKCdwdXR0ZWQtYWxsJykgKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgc2Nyb2xsUG9pbnQgPSAxO1xuXG4gICAgICAgICAgICAgICAgfVxuXG5cbiAgICAgICAgICAgICAgICBfYW5pbWF0aW9uRWxlbXMoIHN0YXJ0LCBlbmQsIHNjcm9sbFBvaW50ICk7XG5cblxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIF9jaGVja0dldEluV2luZG93ID0gZnVuY3Rpb24oKSB7XG5cbiAgICAgICAgICAgICAgICB2YXIgaGVpZ2h0V2luID0gX3dpbmRvdy5oZWlnaHQoKSxcbiAgICAgICAgICAgICAgICAgICAgc2Nyb2xsVG9wV2luID1fd2luZG93LnNjcm9sbFRvcCgpLFxuICAgICAgICAgICAgICAgICAgICBoZWlnaHRPYmogPSBfaGFuZC5oZWlnaHQoKSxcbiAgICAgICAgICAgICAgICAgICAgcG9zaXRpb25PYmogPSBfaGFuZC5vZmZzZXQoKS50b3A7XG5cbiAgICAgICAgICAgICAgICBpZiggKCBoZWlnaHRPYmogKyBwb3NpdGlvbk9iaiA8IGhlaWdodFdpbiArIHNjcm9sbFRvcFdpbiApICYmICQoJy5zaXRlJykuaGVpZ2h0KCkgPiBoZWlnaHRXaW4gKiAyICApIHtcblxuICAgICAgICAgICAgICAgICAgICBfb2JqLmFkZENsYXNzKCdwdXR0ZWQnKTtcblxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG5cbiAgICAgICAgICAgICAgICAgICAgX29iai5yZW1vdmVDbGFzcygncHV0dGVkJyk7XG5cbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBfY2hlY2tQdXRJbldpbmRvdyA9IGZ1bmN0aW9uKCkge1xuXG4gICAgICAgICAgICAgICAgdmFyIGhlaWdodFdpbiA9IF93aW5kb3cuaGVpZ2h0KCksXG4gICAgICAgICAgICAgICAgICAgIGhlaWdodFNpdGUgPSAkKCcuc2l0ZScpLmhlaWdodCgpO1xuXG4gICAgICAgICAgICAgICAgaWYoIGhlaWdodFNpdGUgPD0gaGVpZ2h0V2luICkge1xuXG4gICAgICAgICAgICAgICAgICAgIF9vYmouYWRkQ2xhc3MoJ3B1dHRlZC1hbGwnKTtcblxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG5cbiAgICAgICAgICAgICAgICAgICAgX29iai5yZW1vdmVDbGFzcygncHV0dGVkLWFsbCcpO1xuXG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgX2FuaW1hdGlvbkVsZW1zID0gZnVuY3Rpb24gKCBzdGFydFBvaW50LCBlbmRQb2ludCwgc2Nyb2xsUG9pbnQgKSB7XG5cbiAgICAgICAgICAgICAgICB2YXIgc2VnbWVudCA9IGVuZFBvaW50IC0gc3RhcnRQb2ludDtcblxuICAgICAgICAgICAgICAgIF9oYW5kLmVhY2goIGZ1bmN0aW9uICgpIHtcblxuICAgICAgICAgICAgICAgICAgICB2YXIgY3VyRWxlbSA9ICQoIHRoaXMgKSxcbiAgICAgICAgICAgICAgICAgICAgICAgIHJvdGF0ZVN0YXJ0ID0gY3VyRWxlbS5kYXRhKCdyb3RhdGUtc3RhcnQnKSxcbiAgICAgICAgICAgICAgICAgICAgICAgIHJvdGF0ZUZpbmlzaCA9IGN1ckVsZW0uZGF0YSgncm90YXRlLWZpbmlzaCcpLFxuICAgICAgICAgICAgICAgICAgICAgICAga29mUm90YXRlID0gcm90YXRlU3RhcnQgKyAoIHJvdGF0ZUZpbmlzaCAtIHJvdGF0ZVN0YXJ0ICkgLyBzZWdtZW50ICogKCBfd2luZG93LnNjcm9sbFRvcCgpIC0gc3RhcnRQb2ludCApO1xuXG4gICAgICAgICAgICAgICAgICAgIGlmICggc2Nyb2xsUG9pbnQgPT0gMSApIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgY3VyRWxlbS5jc3MoIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAnLXdlYmtpdC10cmFuc2Zvcm0nOiAncm90YXRlKCAnKyAoIC1yb3RhdGVGaW5pc2ggKSArJ2RlZyApJyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAndHJhbnNmb3JtJzogJ3JvdGF0ZSggJysgKCAtcm90YXRlRmluaXNoICkgKydkZWcgKSdcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gKTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgLy9fb2JqLnJlbW92ZUNsYXNzKCdwdXR0ZWQnKTtcblxuICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKCBzY3JvbGxQb2ludCA9PSAwICkge1xuXG5cbiAgICAgICAgICAgICAgICAgICAgICAgIGN1ckVsZW0uY3NzKCB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJy13ZWJraXQtdHJhbnNmb3JtJzogJ3JvdGF0ZSggJysgKCAtcm90YXRlU3RhcnQgKSArJ2RlZyApJyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAndHJhbnNmb3JtJzogJ3JvdGF0ZSggJysgKCAtcm90YXRlU3RhcnQgKSArJ2RlZyApJ1xuICAgICAgICAgICAgICAgICAgICAgICAgfSApO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAvL19vYmoucmVtb3ZlQ2xhc3MoJ3B1dHRlZCcpO1xuXG5cbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgY3VyRWxlbS5jc3MoIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAnLXdlYmtpdC10cmFuc2Zvcm0nOiAncm90YXRlKCAnKyAoIC1rb2ZSb3RhdGUgKSsnZGVnICknLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICd0cmFuc2Zvcm0nOiAncm90YXRlKCAnKyAoIC1rb2ZSb3RhdGUgKSArJ2RlZyApJ1xuICAgICAgICAgICAgICAgICAgICAgICAgfSApO1xuXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9ICk7XG5cbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBfaW5pdCA9IGZ1bmN0aW9uICgpIHtcblxuICAgICAgICAgICAgICAgIF9vYmpbMF0ub2JqID0gX3NlbGY7XG4gICAgICAgICAgICAgICAgX2FkZEV2ZW50cygpO1xuICAgICAgICAgICAgICAgIF9jaGVja0dldEluV2luZG93KCk7XG4gICAgICAgICAgICAgICAgX2NoZWNrUHV0SW5XaW5kb3coKTtcblxuICAgICAgICAgICAgfTtcblxuICAgICAgICBfaW5pdCgpO1xuICAgIH07XG5cbiAgICB2YXIgQ29udGVudEZ1bGxIZWlnaHQgPSBmdW5jdGlvbiAoIG9iaiApIHtcblxuICAgICAgICB2YXIgX3NlbGYgPSB0aGlzLFxuICAgICAgICAgICAgX29iaiA9IG9iaixcbiAgICAgICAgICAgIF93aW5kb3cgPSAkKHdpbmRvdyksXG4gICAgICAgICAgICBfaGVhZGVyID0gJCgnLnNpdGVfX2hlYWRlcicpO1xuXG4gICAgICAgIHZhciBfYWRkRXZlbnRzID0gZnVuY3Rpb24gKCkge1xuXG4gICAgICAgICAgICAgICAgX3dpbmRvdy5vbigge1xuICAgICAgICAgICAgICAgICAgICByZXNpemU6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgX3NldEhlaWdodCgpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSApO1xuXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgX3NldEhlaWdodCA9IGZ1bmN0aW9uKCkge1xuXG4gICAgICAgICAgICAgICAgdmFyIGhlYWRlckhlaWd0aCA9IF9oZWFkZXIuaGVpZ2h0KCk7XG5cbiAgICAgICAgICAgICAgICBfb2JqLmhlaWdodCggX3dpbmRvdy5oZWlnaHQoKSAtIGhlYWRlckhlaWd0aCApO1xuICAgICAgICAgICAgICAgIF9vYmouY3NzKCB7XG4gICAgICAgICAgICAgICAgICAgICdtaW4taGVpZ2h0JzogX29iai5maW5kKCc+ZGl2OmZpcnN0JykuaGVpZ2h0KClcbiAgICAgICAgICAgICAgICB9ICk7XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgX2luaXQgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgICBfb2JqWzBdLm9iaiA9IF9zZWxmO1xuICAgICAgICAgICAgICAgIF9hZGRFdmVudHMoKTtcbiAgICAgICAgICAgICAgICBfc2V0SGVpZ2h0KCk7XG4gICAgICAgICAgICB9O1xuXG4gICAgICAgIF9pbml0KCk7XG4gICAgfTtcblxuICAgIHZhciBQbGFuc0Nob29zZUhlaWdodCA9IGZ1bmN0aW9uICggb2JqICkge1xuXG4gICAgICAgIHZhciBfc2VsZiA9IHRoaXMsXG4gICAgICAgICAgICBfb2JqID0gb2JqLFxuICAgICAgICAgICAgX3dpbmRvdyA9ICQod2luZG93KSxcbiAgICAgICAgICAgIF9jYXB0aW9uID0gX29iai5maW5kKCcucGxhbnNfX2xpc3RfY2FwdGlvbicpLFxuICAgICAgICAgICAgX2NvbnRlbnQgPSBfb2JqLmZpbmQoJy5wbGFuc19fbGlzdC1yb3c6bm90KC5wbGFuc19fbGlzdF9jYXB0aW9uKScpLFxuICAgICAgICAgICAgX2NhcHRpb25IZWlnaHRzID0gW10sXG4gICAgICAgICAgICBfY29udGVudEhlaWdodHMgPSBbXTtcblxuICAgICAgICB2YXIgX2FkZEV2ZW50cyA9IGZ1bmN0aW9uICgpIHtcblxuICAgICAgICAgICAgICAgIF93aW5kb3cub24oIHtcbiAgICAgICAgICAgICAgICAgICAgbG9hZDogZnVuY3Rpb24oKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIGlmKCBfd2luZG93LndpZHRoKCkgPj0gNzY4ICkge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgX3NldEhlaWdodCgpO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgcmVzaXplOiBmdW5jdGlvbigpIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgaWYoIF93aW5kb3cud2lkdGgoKSA8IDc2OCApIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9jYXB0aW9uLmNzcygge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBoZWlnaHQ6ICcnXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSApO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9jb250ZW50LmNzcygge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBoZWlnaHQ6ICcnXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSApO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgX3NldEhlaWdodCgpO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0gKTtcblxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIF9zZXRIZWlnaHQgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgICBfY2FwdGlvbkhlaWdodHMgPSBbXTtcbiAgICAgICAgICAgICAgICBfY29udGVudEhlaWdodHMgPSBbXTtcblxuICAgICAgICAgICAgICAgIF9jYXB0aW9uLmVhY2goIGZ1bmN0aW9uKCkge1xuXG4gICAgICAgICAgICAgICAgICAgIHZhciBoZWlnaHQgPSAkKHRoaXMpLmlubmVySGVpZ2h0KCk7XG5cbiAgICAgICAgICAgICAgICAgICAgX2NhcHRpb25IZWlnaHRzLnB1c2goIGhlaWdodCApO1xuXG4gICAgICAgICAgICAgICAgfSApO1xuXG4gICAgICAgICAgICAgICAgdmFyIG1heEhlaWdodENhcHRpb24gPSBNYXRoLm1heC5hcHBseShNYXRoLCBfY2FwdGlvbkhlaWdodHMpO1xuXG5cbiAgICAgICAgICAgICAgICBfY29udGVudC5lYWNoKCBmdW5jdGlvbigpIHtcblxuICAgICAgICAgICAgICAgICAgICB2YXIgaGVpZ2h0ID0gJCh0aGlzKS5pbm5lckhlaWdodCgpO1xuXG4gICAgICAgICAgICAgICAgICAgIF9jb250ZW50SGVpZ2h0cy5wdXNoKCBoZWlnaHQgKTtcblxuICAgICAgICAgICAgICAgIH0gKTtcblxuICAgICAgICAgICAgICAgIHZhciBtYXhIZWlnaHRDb250ZW50ID0gTWF0aC5tYXguYXBwbHkoTWF0aCwgX2NvbnRlbnRIZWlnaHRzKTtcblxuICAgICAgICAgICAgICAgIF9jYXB0aW9uLmlubmVySGVpZ2h0KCBtYXhIZWlnaHRDYXB0aW9uICk7XG4gICAgICAgICAgICAgICAgX2NvbnRlbnQuaW5uZXJIZWlnaHQoIG1heEhlaWdodENvbnRlbnQgKTtcblxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIF9pbml0ID0gZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgX29ialswXS5vYmogPSBfc2VsZjtcbiAgICAgICAgICAgICAgICBfYWRkRXZlbnRzKCk7XG4gICAgICAgICAgICB9O1xuXG4gICAgICAgIF9pbml0KCk7XG4gICAgfTtcblxufSApKCk7XG4iXSwic291cmNlUm9vdCI6Ii9zb3VyY2UvIn0=
