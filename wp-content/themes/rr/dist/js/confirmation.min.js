"use strict";!function(){$(function(){$.each($(".clouds"),function(){new t($(this))}),$.each($(".guy"),function(){new n($(this))}),$.each($(".site__content_full"),function(){new i($(this))}),$.each($(".plans"),function(){new s($(this))})});var t=function(t){var n=this,i=t,s=i,o=$(window),a=(o.width(),function(){o.on({resize:function(){h(),e()},load:function(){e()},scroll:function(){e()}})}),e=function(){var t,n=i.offset().top,s=n-o.height(),a=n+i.height(),e=(a-o.scrollTop())/(a-s);e>1?t=0:e<0&&(t=1),e<1&&e>0&&(t=1-e),i.hasClass("putted-all")&&(t=.5),r(s,a,t)},r=function(t,n,i){s.each(function(){var t=$(this),n=100,s=1;t.hasClass("clouds_1")&&(s=-1),0==i?t.css({"-webkit-transform":"translateX("+-n*s+"%)",transform:"translateX("+-n*s+"%)"}):1==i?t.css({"-webkit-transform":"translateX("+-n*s+"%)",transform:"translateX("+-n*s+"%)"}):(i>=.5&&(i=1-i),t.css({"-webkit-transform":"translateX("+200*i*s+"%)",transform:"translateX("+200*i*s+"%)"}))})},h=function(){var t=o.height(),n=$(".site").height();n<=t?i.addClass("putted-all"):i.removeClass("putted-all")},f=function(){i[0].obj=n,a(),h()};f()},n=function(t){var n=this,i=t,s=i.find(".guy__hand"),o=$(window),a=o.width(),e=function(){o.on({resize:function(){a!=o.width()&&(a=o.width()+1,o.width()<768&&s.css({"-webkit-transform":"none",transform:"none"})),f(),h(),r()},load:function(){o.width()>=768&&r()},scroll:function(){o.width()>=768&&r()}})},r=function(){var t,n=o.height(),a=i.offset().top,e=s.offset().top-n,r=a-n+i.height();i.hasClass("putted")&&(e=s.offset().top-n/2,r=n/2.5);var h=(r-o.scrollTop())/(r-e);h>1?t=0:h<0&&(t=1),h<1&&h>0&&(t=1-h),i.hasClass("putted-all")&&(t=1),c(e,r,t)},h=function(){var t=o.height(),n=o.scrollTop(),a=s.height(),e=s.offset().top;a+e<t+n&&$(".site").height()>2*t?i.addClass("putted"):i.removeClass("putted")},f=function(){var t=o.height(),n=$(".site").height();n<=t?i.addClass("putted-all"):i.removeClass("putted-all")},c=function(t,n,i){var a=n-t;s.each(function(){var n=$(this),s=n.data("rotate-start"),e=n.data("rotate-finish"),r=s+(e-s)/a*(o.scrollTop()-t);1==i?n.css({"-webkit-transform":"rotate( "+-e+"deg )",transform:"rotate( "+-e+"deg )"}):0==i?n.css({"-webkit-transform":"rotate( "+-s+"deg )",transform:"rotate( "+-s+"deg )"}):n.css({"-webkit-transform":"rotate( "+-r+"deg )",transform:"rotate( "+-r+"deg )"})})},u=function(){i[0].obj=n,e(),h(),f()};u()},i=function(t){var n=this,i=t,s=$(window),o=$(".site__header"),a=function(){s.on({resize:function(){e()}})},e=function(){var t=o.height();i.height(s.height()-t),i.css({"min-height":i.find(">div:first").height()})},r=function(){i[0].obj=n,a(),e()};r()},s=function(t){var n=this,i=t,s=$(window),o=i.find(".plans__list_caption"),a=i.find(".plans__list-row:not(.plans__list_caption)"),e=[],r=[],h=function(){s.on({load:function(){s.width()>=1024&&f()},resize:function(){s.width()<1024?(o.css({height:""}),a.css({height:""})):f()}})},f=function(){e=[],r=[],o.each(function(){var t=$(this).innerHeight();e.push(t)});var t=Math.max.apply(Math,e);a.each(function(){var t=$(this).innerHeight();r.push(t)});var n=Math.max.apply(Math,r);o.innerHeight(t),a.innerHeight(n)},c=function(){i[0].obj=n,h()};c()}}();
"use strict";!function(){$(function(){$.each($(".confirmation"),function(){new n($(this))})});var n=function(n){var e,a,o=this,i=n,s=i.find(".confirmation__data-paste"),t=function(){var n="",o="",i=[];for(var t in e)var r=e[t];void 0!=e.ratePlan&&$.each(e.ratePlan,function(){var a=e.ratePlan.value.split(" ");if("session pricing"===e.ratePlan.sessionType)n="<span>"+e.ratePlan.sessionType+" ("+a[0]+" sessions)</span>";else if("minute pricing"===e.ratePlan.sessionType){var o=a[0].replace(/[^0-9]+/g,"");o>1e5&&(o=o/1e6+"M"),n="<span>"+e.ratePlan.sessionType+" ("+o+" minutes ("+a[2]+"/minute)</span>"}});for(var c in a)i.push(c);i.length>0&&(o=1==i.length?"+ "+i.length+" service":"+ "+i.length+" service"),s.html("You chose "+n+", "+r+" "+o+").")},r=function(){void 0!=localStorage.radioChoose?(e=JSON.parse(localStorage.radioChoose),a=JSON.parse(localStorage.checkboxChoose),t()):window.location.href=$("body").data("src")},c=function(){i[0].obj=o,r()};c()}}();
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImpxdWVyeS5tYWluLmpzIiwianF1ZXJ5LmNvbmZpcm1hdGlvbi5qcyJdLCJuYW1lcyI6WyIkIiwiZWFjaCIsIkNsb3Vkc0FuaW1hdGVkIiwidGhpcyIsIkd1eUFuaW1hdGVkIiwiQ29udGVudEZ1bGxIZWlnaHQiLCJQbGFuc0Nob29zZUhlaWdodCIsIm9iaiIsIl9zZWxmIiwiX29iaiIsIl9pdGVtcyIsIl93aW5kb3ciLCJ3aW5kb3ciLCJfYWRkRXZlbnRzIiwid2lkdGgiLCJvbiIsInJlc2l6ZSIsIl9jaGVja1B1dEluV2luZG93IiwiX2NoZWNrU2Nyb2xsIiwibG9hZCIsInNjcm9sbCIsInNjcm9sbFBvaW50IiwidG9wUG9zIiwib2Zmc2V0IiwidG9wIiwic3RhcnQiLCJoZWlnaHQiLCJlbmQiLCJ4Iiwic2Nyb2xsVG9wIiwiaGFzQ2xhc3MiLCJfYW5pbWF0aW9uRWxlbXMiLCJzdGFydFBvaW50IiwiZW5kUG9pbnQiLCJjdXJFbGVtIiwidHJhbnNsYXRlRmluaXNoIiwiY3NzIiwiLXdlYmtpdC10cmFuc2Zvcm0iLCJ0cmFuc2Zvcm0iLCJoZWlnaHRXaW4iLCJoZWlnaHRTaXRlIiwiYWRkQ2xhc3MiLCJyZW1vdmVDbGFzcyIsIl9pbml0IiwiX2hhbmQiLCJmaW5kIiwiX2dsb2JhbFdpZHRoIiwiX2NoZWNrR2V0SW5XaW5kb3ciLCJ3aW5kb3dIIiwic2Nyb2xsVG9wV2luIiwiaGVpZ2h0T2JqIiwicG9zaXRpb25PYmoiLCJzZWdtZW50Iiwicm90YXRlU3RhcnQiLCJkYXRhIiwicm90YXRlRmluaXNoIiwia29mUm90YXRlIiwiX2hlYWRlciIsIl9zZXRIZWlnaHQiLCJoZWFkZXJIZWlndGgiLCJtaW4taGVpZ2h0IiwiX2NhcHRpb24iLCJfY29udGVudCIsIl9jYXB0aW9uSGVpZ2h0cyIsIl9jb250ZW50SGVpZ2h0cyIsImlubmVySGVpZ2h0IiwicHVzaCIsIm1heEhlaWdodENhcHRpb24iLCJNYXRoIiwibWF4IiwiYXBwbHkiLCJtYXhIZWlnaHRDb250ZW50IiwiUGFzdGVEYXRhIiwiX2RhdGFSYWRpbyIsIl9kYXRhQ2hlY2tib3giLCJfY2hvc2VuRGF0YSIsIl93cml0ZUluQmxvY2siLCJkaXZSYXRlIiwibnVtIiwiYXJyIiwia2V5IiwiaXRlbSIsInVuZGVmaW5lZCIsInJhdGVQbGFuIiwidmFsdWUiLCJzcGxpdCIsInNlc3Npb25UeXBlIiwibWludXRlcyIsInJlcGxhY2UiLCJrZXkxIiwibGVuZ3RoIiwiaHRtbCIsIl9nZXRTZXNzaW9uRGF0YSIsImxvY2FsU3RvcmFnZSIsInJhZGlvQ2hvb3NlIiwiSlNPTiIsInBhcnNlIiwiY2hlY2tib3hDaG9vc2UiLCJsb2NhdGlvbiIsImhyZWYiXSwibWFwcGluZ3MiOiJBQUFBLGNBQ0EsV0FFSUEsRUFBRyxXQUVDQSxFQUFFQyxLQUFNRCxFQUFFLFdBQVksV0FFbEIsR0FBSUUsR0FBZ0JGLEVBQUVHLFNBSTFCSCxFQUFFQyxLQUFNRCxFQUFFLFFBQVMsV0FFZixHQUFJSSxHQUFhSixFQUFFRyxTQUl2QkgsRUFBRUMsS0FBTUQsRUFBRSx1QkFBd0IsV0FFOUIsR0FBSUssR0FBbUJMLEVBQUVHLFNBSTdCSCxFQUFFQyxLQUFNRCxFQUFFLFVBQVcsV0FFakIsR0FBSU0sR0FBbUJOLEVBQUVHLFVBTWpDLElBQUlELEdBQWlCLFNBQVVLLEdBRzNCLEdBQUlDLEdBQVFMLEtBQ1JNLEVBQU9GLEVBQ1BHLEVBQVNELEVBQ1RFLEVBQVVYLEVBQUVZLFFBSVpDLEdBSGVGLEVBQVFHLFFBR1YsV0FFVEgsRUFBUUksSUFDSkMsT0FBUSxXQUVKQyxJQUNBQyxLQUdKQyxLQUFNLFdBRUZELEtBR0pFLE9BQVEsV0FFSkYsU0FNWkEsRUFBZSxXQUVYLEdBR0lHLEdBSEFDLEVBQVNiLEVBQUtjLFNBQVNDLElBQ3ZCQyxFQUFRSCxFQUFTWCxFQUFRZSxTQUN6QkMsRUFBTUwsRUFBU2IsRUFBS2lCLFNBR3BCRSxHQUFNRCxFQUFNaEIsRUFBUWtCLGNBQWtCRixFQUFPRixFQUU1Q0csR0FBSSxFQUVMUCxFQUFjLEVBR05PLEVBQUksSUFF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LEtBQU1GLEVBQU0sR0FBSSx3QkFFbEUsSUFBd0MsbUJBQXBDWCxFQUFXVSxTQUFTRyxZQUFtQyxDQUU5RCxHQUFJQyxHQUFVSCxFQUFNLEdBQUdJLFFBQVEsV0FBVyxHQUV0Q0QsR0FBVSxNQUVWQSxFQUFVQSxFQUFRLElBQVUsS0FJaENWLEVBQVUsU0FBVUosRUFBV1UsU0FBU0csWUFBYSxLQUFNQyxFQUFTLGFBQWVILEVBQU0sR0FBSyxvQkFTMUcsS0FBSyxHQUFJSyxLQUFRZixHQUViSyxFQUFJYixLQUFLdUIsRUFJVFYsR0FBSVcsT0FBUyxJQUlUWixFQUZjLEdBQWRDLEVBQUlXLE9BRUUsS0FBT1gsRUFBSVcsT0FBUyxXQUlwQixLQUFPWCxFQUFJVyxPQUFTLFlBTWxDZixFQUFZZ0IsS0FBSyxhQUFlZCxFQUFVLEtBQU9JLEVBQU8sSUFBTUgsRUFBTSxPQUd4RWMsRUFBa0IsV0FFa0JWLFFBQTVCVyxhQUFhQyxhQUVickIsRUFBYXNCLEtBQUtDLE1BQU9ILGFBQWFDLGFBQ3RDcEIsRUFBZ0JxQixLQUFLQyxNQUFPSCxhQUFhSSxnQkFFekNyQixLQUlBaEUsT0FBT3NGLFNBQVNDLEtBQU9uRyxFQUFFLFFBQVFzRCxLQUFLLFFBSzlDWCxFQUFRLFdBRUpsQyxFQUFLLEdBQUdGLElBQU1DLEVBQ2RvRixJQUdSakQiLCJmaWxlIjoiY29uZmlybWF0aW9uLm1pbi5qcyIsInNvdXJjZXNDb250ZW50IjpbIlwidXNlIHN0cmljdFwiO1xuKCBmdW5jdGlvbigpIHtcblxuICAgICQoIGZ1bmN0aW9uKCkge1xuXG4gICAgICAgICQuZWFjaCggJCgnLmNsb3VkcycpLCBmdW5jdGlvbiAoKSB7XG5cbiAgICAgICAgICAgIG5ldyBDbG91ZHNBbmltYXRlZCggJCh0aGlzKSApO1xuXG4gICAgICAgIH0gKTtcblxuICAgICAgICAkLmVhY2goICQoJy5ndXknKSwgZnVuY3Rpb24gKCkge1xuXG4gICAgICAgICAgICBuZXcgR3V5QW5pbWF0ZWQoICQodGhpcykgKTtcblxuICAgICAgICB9ICk7XG5cbiAgICAgICAgJC5lYWNoKCAkKCcuc2l0ZV9fY29udGVudF9mdWxsJyksIGZ1bmN0aW9uICgpIHtcblxuICAgICAgICAgICAgbmV3IENvbnRlbnRGdWxsSGVpZ2h0KCAkKHRoaXMpICk7XG5cbiAgICAgICAgfSApO1xuXG4gICAgICAgICQuZWFjaCggJCgnLnBsYW5zJyksIGZ1bmN0aW9uICgpIHtcblxuICAgICAgICAgICAgbmV3IFBsYW5zQ2hvb3NlSGVpZ2h0KCAkKHRoaXMpICk7XG5cbiAgICAgICAgfSApO1xuXG4gICAgfSApO1xuXG4gICAgdmFyIENsb3Vkc0FuaW1hdGVkID0gZnVuY3Rpb24gKG9iaikge1xuXG4gICAgICAgIC8vcHJpdmF0ZSBwcm9wZXJ0aWVzXG4gICAgICAgIHZhciBfc2VsZiA9IHRoaXMsXG4gICAgICAgICAgICBfb2JqID0gb2JqLFxuICAgICAgICAgICAgX2l0ZW1zID0gX29iaixcbiAgICAgICAgICAgIF93aW5kb3cgPSAkKHdpbmRvdyksXG4gICAgICAgICAgICBfZ2xvYmFsV2lkdGggPSBfd2luZG93LndpZHRoKCk7XG5cbiAgICAgICAgLy9wcml2YXRlIG1ldGhvZHNcbiAgICAgICAgdmFyIF9hZGRFdmVudHMgPSBmdW5jdGlvbiAoKSB7XG5cbiAgICAgICAgICAgICAgICBfd2luZG93Lm9uKCB7XG4gICAgICAgICAgICAgICAgICAgIHJlc2l6ZTogZnVuY3Rpb24oKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIF9jaGVja1B1dEluV2luZG93KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBfY2hlY2tTY3JvbGwoKTtcblxuICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICBsb2FkOiBmdW5jdGlvbigpIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgX2NoZWNrU2Nyb2xsKCk7XG5cbiAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgc2Nyb2xsOiBmdW5jdGlvbiAoKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIF9jaGVja1Njcm9sbCgpO1xuXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9ICk7XG5cbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBfY2hlY2tTY3JvbGwgPSBmdW5jdGlvbigpe1xuXG4gICAgICAgICAgICAgICAgdmFyIHRvcFBvcyA9IF9vYmoub2Zmc2V0KCkudG9wICxcbiAgICAgICAgICAgICAgICAgICAgc3RhcnQgPSB0b3BQb3MgLSBfd2luZG93LmhlaWdodCgpLFxuICAgICAgICAgICAgICAgICAgICBlbmQgPSB0b3BQb3MgKyBfb2JqLmhlaWdodCgpLFxuICAgICAgICAgICAgICAgICAgICBzY3JvbGxQb2ludDtcblxuICAgICAgICAgICAgICAgIHZhciB4ID0gKCBlbmQgLSBfd2luZG93LnNjcm9sbFRvcCgpICkgLyAoIGVuZCAtICBzdGFydCApO1xuXG4gICAgICAgICAgICAgICAgaWYgKCB4ID4gMSApIHtcblxuICAgICAgICAgICAgICAgICAgICBzY3JvbGxQb2ludCA9IDA7XG5cblxuICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoIHggPCAwICkge1xuXG4gICAgICAgICAgICAgICAgICAgIHNjcm9sbFBvaW50ID0gMTtcblxuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIGlmKCAoIHggPCAxICkgJiYgKCB4ID4gMCApICl7XG5cbiAgICAgICAgICAgICAgICAgICAgc2Nyb2xsUG9pbnQgPSAxIC0geDtcblxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiggIF9vYmouaGFzQ2xhc3MoJ3B1dHRlZC1hbGwnKSApIHtcblxuICAgICAgICAgICAgICAgICAgICBzY3JvbGxQb2ludCA9IDAuNTtcblxuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIF9hbmltYXRpb25FbGVtcyggc3RhcnQsIGVuZCwgc2Nyb2xsUG9pbnQgKTtcblxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIF9hbmltYXRpb25FbGVtcyA9IGZ1bmN0aW9uICggc3RhcnRQb2ludCwgZW5kUG9pbnQsIHNjcm9sbFBvaW50ICkge1xuXG4gICAgICAgICAgICAgICAgX2l0ZW1zLmVhY2goIGZ1bmN0aW9uICgpIHtcblxuICAgICAgICAgICAgICAgICAgICB2YXIgY3VyRWxlbSA9ICQoIHRoaXMgKSxcbiAgICAgICAgICAgICAgICAgICAgICAgIHRyYW5zbGF0ZVN0YXJ0ID0gMCxcbiAgICAgICAgICAgICAgICAgICAgICAgIHRyYW5zbGF0ZUZpbmlzaCA9IDEwMCxcbiAgICAgICAgICAgICAgICAgICAgICAgIHggPSAxO1xuXG4gICAgICAgICAgICAgICAgICAgIGlmKCBjdXJFbGVtLmhhc0NsYXNzKCdjbG91ZHNfMScpICkge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICB4ID0gLTE7XG5cbiAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgIGlmICggc2Nyb2xsUG9pbnQgPT0gMCApIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgY3VyRWxlbS5jc3MoIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICctd2Via2l0LXRyYW5zZm9ybSc6ICd0cmFuc2xhdGVYKCcgKyggLXRyYW5zbGF0ZUZpbmlzaCAqIHggKSsgJyUpJyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAndHJhbnNmb3JtJzogJ3RyYW5zbGF0ZVgoJyArKCAtdHJhbnNsYXRlRmluaXNoICogeCApKyAnJSknXG5cbiAgICAgICAgICAgICAgICAgICAgICAgIH0gKTtcblxuICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKCBzY3JvbGxQb2ludCA9PSAxICkge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICBjdXJFbGVtLmNzcygge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJy13ZWJraXQtdHJhbnNmb3JtJzogJ3RyYW5zbGF0ZVgoJyArKCAtdHJhbnNsYXRlRmluaXNoICogeCApKyAnJSknLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICd0cmFuc2Zvcm0nOiAndHJhbnNsYXRlWCgnICsoIC10cmFuc2xhdGVGaW5pc2ggKiB4ICkrICclKSdcblxuICAgICAgICAgICAgICAgICAgICAgICAgfSApO1xuXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG5cblxuICAgICAgICAgICAgICAgICAgICAgICAgLy9pZiggc2Nyb2xsUG9pbnQgPCAwLjUgJiYgc2Nyb2xsUG9pbnQgPiAwICkge1xuICAgICAgICAgICAgICAgICAgICAgICAgLy9cbiAgICAgICAgICAgICAgICAgICAgICAgIC8vICAgIGN1ckVsZW0uY3NzKCB7XG4gICAgICAgICAgICAgICAgICAgICAgICAvL1xuICAgICAgICAgICAgICAgICAgICAgICAgLy8gICAgICAgICctd2Via2l0LXRyYW5zZm9ybSc6ICd0cmFuc2xhdGVYKCcgKyggc2Nyb2xsUG9pbnQgKiAyMDAgKiB4ICkrICclKScsXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyAgICAgICAgJ3RyYW5zZm9ybSc6ICd0cmFuc2xhdGVYKCcgKyggc2Nyb2xsUG9pbnQgKiAyMDAgKiB4ICkrICclKSdcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyAgICB9ICk7XG4gICAgICAgICAgICAgICAgICAgICAgICAvL1xuICAgICAgICAgICAgICAgICAgICAgICAgLy99XG4gICAgICAgICAgICAgICAgICAgICAgICAvL1xuICAgICAgICAgICAgICAgICAgICAgICAgLy9cbiAgICAgICAgICAgICAgICAgICAgICAgIC8vaWYoIHNjcm9sbFBvaW50ID49IDAuNSAmJiBzY3JvbGxQb2ludCA8IDAuOCApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyAgICBjdXJFbGVtLmNzcygge1xuICAgICAgICAgICAgICAgICAgICAgICAgLy9cbiAgICAgICAgICAgICAgICAgICAgICAgIC8vICAgICAgICAnLXdlYmtpdC10cmFuc2Zvcm0nOiAndHJhbnNsYXRlWCgnICsoIHRyYW5zbGF0ZUZpbmlzaCAqIHggKSsgJyUpJyxcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vICAgICAgICAndHJhbnNmb3JtJzogJ3RyYW5zbGF0ZVgoJyArKCB0cmFuc2xhdGVGaW5pc2ggKiB4ICkrICclKSdcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyAgICB9ICk7XG4gICAgICAgICAgICAgICAgICAgICAgICAvL1xuICAgICAgICAgICAgICAgICAgICAgICAgLy99XG4gICAgICAgICAgICAgICAgICAgICAgICAvL1xuICAgICAgICAgICAgICAgICAgICAgICAgLy9pZiggc2Nyb2xsUG9pbnQgPj0gMC44ICkge1xuICAgICAgICAgICAgICAgICAgICAgICAgLy9cbiAgICAgICAgICAgICAgICAgICAgICAgIC8vICAgIHNjcm9sbFBvaW50ID0gMS4zIC0gc2Nyb2xsUG9pbnQ7XG4gICAgICAgICAgICAgICAgICAgICAgICAvL1xuICAgICAgICAgICAgICAgICAgICAgICAgLy8gICAgY3VyRWxlbS5jc3MoIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyAgICAgICAgJy13ZWJraXQtdHJhbnNmb3JtJzogJ3RyYW5zbGF0ZVgoJyArKCBzY3JvbGxQb2ludCAqIDIwMCAqIHggKSsgJyUpJyxcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vICAgICAgICAndHJhbnNmb3JtJzogJ3RyYW5zbGF0ZVgoJyArKCBzY3JvbGxQb2ludCAqIDIwMCAqIHggKSsgJyUpJ1xuICAgICAgICAgICAgICAgICAgICAgICAgLy9cbiAgICAgICAgICAgICAgICAgICAgICAgIC8vICAgIH0gKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vXG4gICAgICAgICAgICAgICAgICAgICAgICAvL31cblxuICAgICAgICAgICAgICAgICAgICAgICAgaWYoIHNjcm9sbFBvaW50ID49IDAuNSApIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNjcm9sbFBvaW50ID0gMSAtIHNjcm9sbFBvaW50O1xuXG4gICAgICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIGN1ckVsZW0uY3NzKCB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAnLXdlYmtpdC10cmFuc2Zvcm0nOiAndHJhbnNsYXRlWCgnICsoIHNjcm9sbFBvaW50ICogMjAwICogeCApKyAnJSknLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICd0cmFuc2Zvcm0nOiAndHJhbnNsYXRlWCgnICsoIHNjcm9sbFBvaW50ICogMjAwICogeCApKyAnJSknXG5cbiAgICAgICAgICAgICAgICAgICAgICAgIH0gKTtcblxuXG4gICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIH0gKTtcblxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIF9jaGVja1B1dEluV2luZG93ID0gZnVuY3Rpb24oKSB7XG5cbiAgICAgICAgICAgICAgICB2YXIgaGVpZ2h0V2luID0gX3dpbmRvdy5oZWlnaHQoKSxcbiAgICAgICAgICAgICAgICAgICAgaGVpZ2h0U2l0ZSA9ICQoJy5zaXRlJykuaGVpZ2h0KCk7XG5cbiAgICAgICAgICAgICAgICBpZiggaGVpZ2h0U2l0ZSA8PSBoZWlnaHRXaW4gKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgX29iai5hZGRDbGFzcygncHV0dGVkLWFsbCcpO1xuXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcblxuICAgICAgICAgICAgICAgICAgICBfb2JqLnJlbW92ZUNsYXNzKCdwdXR0ZWQtYWxsJyk7XG5cbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBfaW5pdCA9IGZ1bmN0aW9uICgpIHtcblxuICAgICAgICAgICAgICAgIF9vYmpbMF0ub2JqID0gX3NlbGY7XG4gICAgICAgICAgICAgICAgX2FkZEV2ZW50cygpO1xuICAgICAgICAgICAgICAgIF9jaGVja1B1dEluV2luZG93KCk7XG5cbiAgICAgICAgICAgIH07XG5cbiAgICAgICAgX2luaXQoKTtcbiAgICB9O1xuXG4gICAgdmFyIEd1eUFuaW1hdGVkID0gZnVuY3Rpb24gKG9iaikge1xuXG4gICAgICAgIC8vcHJpdmF0ZSBwcm9wZXJ0aWVzXG4gICAgICAgIHZhciBfc2VsZiA9IHRoaXMsXG4gICAgICAgICAgICBfb2JqID0gb2JqLFxuICAgICAgICAgICAgX2hhbmQgPSBfb2JqLmZpbmQoJy5ndXlfX2hhbmQnKSxcbiAgICAgICAgICAgIF93aW5kb3cgPSAkKHdpbmRvdyksXG4gICAgICAgICAgICBfZ2xvYmFsV2lkdGggPSBfd2luZG93LndpZHRoKCk7XG5cbiAgICAgICAgLy9wcml2YXRlIG1ldGhvZHNcbiAgICAgICAgdmFyIF9hZGRFdmVudHMgPSBmdW5jdGlvbiAoKSB7XG5cbiAgICAgICAgICAgICAgICBfd2luZG93Lm9uKCB7XG4gICAgICAgICAgICAgICAgICAgIHJlc2l6ZTogZnVuY3Rpb24oKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIGlmKCBfZ2xvYmFsV2lkdGggIT0gX3dpbmRvdy53aWR0aCgpICkge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgX2dsb2JhbFdpZHRoID0gX3dpbmRvdy53aWR0aCgpICsgMTtcblxuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYoIF93aW5kb3cud2lkdGgoKSA8IDc2OCApIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfaGFuZC5jc3MoIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICctd2Via2l0LXRyYW5zZm9ybSc6ICdub25lJyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICd0cmFuc2Zvcm0nOiAnbm9uZSdcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSApO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIF9jaGVja1B1dEluV2luZG93KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBfY2hlY2tHZXRJbldpbmRvdygpO1xuICAgICAgICAgICAgICAgICAgICAgICAgX2NoZWNrU2Nyb2xsKCk7XG5cbiAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgbG9hZDogZnVuY3Rpb24oKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIGlmKCBfd2luZG93LndpZHRoKCkgPj0gNzY4ICkge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgX2NoZWNrU2Nyb2xsKCk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICBzY3JvbGw6IGZ1bmN0aW9uICgpIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKF93aW5kb3cud2lkdGgoKSA+PSA3NjgpIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9jaGVja1Njcm9sbCgpO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0gKTtcblxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIF9jaGVja1Njcm9sbCA9IGZ1bmN0aW9uKCkge1xuXG4gICAgICAgICAgICAgICAgdmFyIHdpbmRvd0ggPSBfd2luZG93LmhlaWdodCgpLFxuICAgICAgICAgICAgICAgICAgICB0b3BQb3MgPSBfb2JqLm9mZnNldCgpLnRvcCxcbiAgICAgICAgICAgICAgICAgICAgc3RhcnQgPSBfaGFuZC5vZmZzZXQoKS50b3AgLSB3aW5kb3dILFxuICAgICAgICAgICAgICAgICAgICBlbmQgPSB0b3BQb3MgLSB3aW5kb3dIICsgX29iai5oZWlnaHQoKSxcbiAgICAgICAgICAgICAgICAgICAgc2Nyb2xsUG9pbnQ7XG5cbiAgICAgICAgICAgICAgICBpZiggIF9vYmouaGFzQ2xhc3MoJ3B1dHRlZCcpICkge1xuXG4gICAgICAgICAgICAgICAgICAgIHN0YXJ0ID0gX2hhbmQub2Zmc2V0KCkudG9wIC0gd2luZG93SC8yO1xuICAgICAgICAgICAgICAgICAgICBlbmQgPSB3aW5kb3dILzIuNTtcblxuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIHZhciB4ID0gKCBlbmQgLSBfd2luZG93LnNjcm9sbFRvcCgpICkgLyAoIGVuZCAtICBzdGFydCApO1xuXG4gICAgICAgICAgICAgICAgaWYgKCB4ID4gMSApIHtcblxuICAgICAgICAgICAgICAgICAgICBzY3JvbGxQb2ludCA9IDA7XG5cblxuICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoIHggPCAwICkge1xuXG4gICAgICAgICAgICAgICAgICAgIHNjcm9sbFBvaW50ID0gMTtcblxuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIGlmKCAoIHggPCAxICkgJiYgKCB4ID4gMCApICl7XG5cbiAgICAgICAgICAgICAgICAgICAgc2Nyb2xsUG9pbnQgPSAxIC0geDtcblxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiggIF9vYmouaGFzQ2xhc3MoJ3B1dHRlZC1hbGwnKSApIHtcblxuICAgICAgICAgICAgICAgICAgICBzY3JvbGxQb2ludCA9IDE7XG5cbiAgICAgICAgICAgICAgICB9XG5cblxuICAgICAgICAgICAgICAgIF9hbmltYXRpb25FbGVtcyggc3RhcnQsIGVuZCwgc2Nyb2xsUG9pbnQgKTtcblxuXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgX2NoZWNrR2V0SW5XaW5kb3cgPSBmdW5jdGlvbigpIHtcblxuICAgICAgICAgICAgICAgIHZhciBoZWlnaHRXaW4gPSBfd2luZG93LmhlaWdodCgpLFxuICAgICAgICAgICAgICAgICAgICBzY3JvbGxUb3BXaW4gPV93aW5kb3cuc2Nyb2xsVG9wKCksXG4gICAgICAgICAgICAgICAgICAgIGhlaWdodE9iaiA9IF9oYW5kLmhlaWdodCgpLFxuICAgICAgICAgICAgICAgICAgICBwb3NpdGlvbk9iaiA9IF9oYW5kLm9mZnNldCgpLnRvcDtcblxuICAgICAgICAgICAgICAgIGlmKCAoIGhlaWdodE9iaiArIHBvc2l0aW9uT2JqIDwgaGVpZ2h0V2luICsgc2Nyb2xsVG9wV2luICkgJiYgJCgnLnNpdGUnKS5oZWlnaHQoKSA+IGhlaWdodFdpbiAqIDIgICkge1xuXG4gICAgICAgICAgICAgICAgICAgIF9vYmouYWRkQ2xhc3MoJ3B1dHRlZCcpO1xuXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcblxuICAgICAgICAgICAgICAgICAgICBfb2JqLnJlbW92ZUNsYXNzKCdwdXR0ZWQnKTtcblxuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIF9jaGVja1B1dEluV2luZG93ID0gZnVuY3Rpb24oKSB7XG5cbiAgICAgICAgICAgICAgICB2YXIgaGVpZ2h0V2luID0gX3dpbmRvdy5oZWlnaHQoKSxcbiAgICAgICAgICAgICAgICAgICAgaGVpZ2h0U2l0ZSA9ICQoJy5zaXRlJykuaGVpZ2h0KCk7XG5cbiAgICAgICAgICAgICAgICBpZiggaGVpZ2h0U2l0ZSA8PSBoZWlnaHRXaW4gKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgX29iai5hZGRDbGFzcygncHV0dGVkLWFsbCcpO1xuXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcblxuICAgICAgICAgICAgICAgICAgICBfb2JqLnJlbW92ZUNsYXNzKCdwdXR0ZWQtYWxsJyk7XG5cbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBfYW5pbWF0aW9uRWxlbXMgPSBmdW5jdGlvbiAoIHN0YXJ0UG9pbnQsIGVuZFBvaW50LCBzY3JvbGxQb2ludCApIHtcblxuICAgICAgICAgICAgICAgIHZhciBzZWdtZW50ID0gZW5kUG9pbnQgLSBzdGFydFBvaW50O1xuXG4gICAgICAgICAgICAgICAgX2hhbmQuZWFjaCggZnVuY3Rpb24gKCkge1xuXG4gICAgICAgICAgICAgICAgICAgIHZhciBjdXJFbGVtID0gJCggdGhpcyApLFxuICAgICAgICAgICAgICAgICAgICAgICAgcm90YXRlU3RhcnQgPSBjdXJFbGVtLmRhdGEoJ3JvdGF0ZS1zdGFydCcpLFxuICAgICAgICAgICAgICAgICAgICAgICAgcm90YXRlRmluaXNoID0gY3VyRWxlbS5kYXRhKCdyb3RhdGUtZmluaXNoJyksXG4gICAgICAgICAgICAgICAgICAgICAgICBrb2ZSb3RhdGUgPSByb3RhdGVTdGFydCArICggcm90YXRlRmluaXNoIC0gcm90YXRlU3RhcnQgKSAvIHNlZ21lbnQgKiAoIF93aW5kb3cuc2Nyb2xsVG9wKCkgLSBzdGFydFBvaW50ICk7XG5cbiAgICAgICAgICAgICAgICAgICAgaWYgKCBzY3JvbGxQb2ludCA9PSAxICkge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICBjdXJFbGVtLmNzcygge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICctd2Via2l0LXRyYW5zZm9ybSc6ICdyb3RhdGUoICcrICggLXJvdGF0ZUZpbmlzaCApICsnZGVnICknLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICd0cmFuc2Zvcm0nOiAncm90YXRlKCAnKyAoIC1yb3RhdGVGaW5pc2ggKSArJ2RlZyApJ1xuICAgICAgICAgICAgICAgICAgICAgICAgfSApO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAvL19vYmoucmVtb3ZlQ2xhc3MoJ3B1dHRlZCcpO1xuXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoIHNjcm9sbFBvaW50ID09IDAgKSB7XG5cblxuICAgICAgICAgICAgICAgICAgICAgICAgY3VyRWxlbS5jc3MoIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAnLXdlYmtpdC10cmFuc2Zvcm0nOiAncm90YXRlKCAnKyAoIC1yb3RhdGVTdGFydCApICsnZGVnICknLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICd0cmFuc2Zvcm0nOiAncm90YXRlKCAnKyAoIC1yb3RhdGVTdGFydCApICsnZGVnICknXG4gICAgICAgICAgICAgICAgICAgICAgICB9ICk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIC8vX29iai5yZW1vdmVDbGFzcygncHV0dGVkJyk7XG5cblxuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICBjdXJFbGVtLmNzcygge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICctd2Via2l0LXRyYW5zZm9ybSc6ICdyb3RhdGUoICcrICggLWtvZlJvdGF0ZSApKydkZWcgKScsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJ3RyYW5zZm9ybSc6ICdyb3RhdGUoICcrICggLWtvZlJvdGF0ZSApICsnZGVnICknXG4gICAgICAgICAgICAgICAgICAgICAgICB9ICk7XG5cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0gKTtcblxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIF9pbml0ID0gZnVuY3Rpb24gKCkge1xuXG4gICAgICAgICAgICAgICAgX29ialswXS5vYmogPSBfc2VsZjtcbiAgICAgICAgICAgICAgICBfYWRkRXZlbnRzKCk7XG4gICAgICAgICAgICAgICAgX2NoZWNrR2V0SW5XaW5kb3coKTtcbiAgICAgICAgICAgICAgICBfY2hlY2tQdXRJbldpbmRvdygpO1xuXG4gICAgICAgICAgICB9O1xuXG4gICAgICAgIF9pbml0KCk7XG4gICAgfTtcblxuICAgIHZhciBDb250ZW50RnVsbEhlaWdodCA9IGZ1bmN0aW9uICggb2JqICkge1xuXG4gICAgICAgIHZhciBfc2VsZiA9IHRoaXMsXG4gICAgICAgICAgICBfb2JqID0gb2JqLFxuICAgICAgICAgICAgX3dpbmRvdyA9ICQod2luZG93KSxcbiAgICAgICAgICAgIF9oZWFkZXIgPSAkKCcuc2l0ZV9faGVhZGVyJyk7XG5cbiAgICAgICAgdmFyIF9hZGRFdmVudHMgPSBmdW5jdGlvbiAoKSB7XG5cbiAgICAgICAgICAgICAgICBfd2luZG93Lm9uKCB7XG4gICAgICAgICAgICAgICAgICAgIHJlc2l6ZTogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBfc2V0SGVpZ2h0KCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9ICk7XG5cbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBfc2V0SGVpZ2h0ID0gZnVuY3Rpb24oKSB7XG5cbiAgICAgICAgICAgICAgICB2YXIgaGVhZGVySGVpZ3RoID0gX2hlYWRlci5oZWlnaHQoKTtcblxuICAgICAgICAgICAgICAgIF9vYmouaGVpZ2h0KCBfd2luZG93LmhlaWdodCgpIC0gaGVhZGVySGVpZ3RoICk7XG4gICAgICAgICAgICAgICAgX29iai5jc3MoIHtcbiAgICAgICAgICAgICAgICAgICAgJ21pbi1oZWlnaHQnOiBfb2JqLmZpbmQoJz5kaXY6Zmlyc3QnKS5oZWlnaHQoKVxuICAgICAgICAgICAgICAgIH0gKTtcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBfaW5pdCA9IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgIF9vYmpbMF0ub2JqID0gX3NlbGY7XG4gICAgICAgICAgICAgICAgX2FkZEV2ZW50cygpO1xuICAgICAgICAgICAgICAgIF9zZXRIZWlnaHQoKTtcbiAgICAgICAgICAgIH07XG5cbiAgICAgICAgX2luaXQoKTtcbiAgICB9O1xuXG4gICAgdmFyIFBsYW5zQ2hvb3NlSGVpZ2h0ID0gZnVuY3Rpb24gKCBvYmogKSB7XG5cbiAgICAgICAgdmFyIF9zZWxmID0gdGhpcyxcbiAgICAgICAgICAgIF9vYmogPSBvYmosXG4gICAgICAgICAgICBfd2luZG93ID0gJCh3aW5kb3cpLFxuICAgICAgICAgICAgX2NhcHRpb24gPSBfb2JqLmZpbmQoJy5wbGFuc19fbGlzdF9jYXB0aW9uJyksXG4gICAgICAgICAgICBfY29udGVudCA9IF9vYmouZmluZCgnLnBsYW5zX19saXN0LXJvdzpub3QoLnBsYW5zX19saXN0X2NhcHRpb24pJyksXG4gICAgICAgICAgICBfY2FwdGlvbkhlaWdodHMgPSBbXSxcbiAgICAgICAgICAgIF9jb250ZW50SGVpZ2h0cyA9IFtdO1xuXG4gICAgICAgIHZhciBfYWRkRXZlbnRzID0gZnVuY3Rpb24gKCkge1xuXG4gICAgICAgICAgICAgICAgX3dpbmRvdy5vbigge1xuICAgICAgICAgICAgICAgICAgICBsb2FkOiBmdW5jdGlvbigpIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgaWYoIF93aW5kb3cud2lkdGgoKSA+PSAxMDI0ICkge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgX3NldEhlaWdodCgpO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgcmVzaXplOiBmdW5jdGlvbigpIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgaWYoIF93aW5kb3cud2lkdGgoKSA8IDEwMjQgKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBfY2FwdGlvbi5jc3MoIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaGVpZ2h0OiAnJ1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBfY29udGVudC5jc3MoIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaGVpZ2h0OiAnJ1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gKTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9zZXRIZWlnaHQoKTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9ICk7XG5cbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBfc2V0SGVpZ2h0ID0gZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgX2NhcHRpb25IZWlnaHRzID0gW107XG4gICAgICAgICAgICAgICAgX2NvbnRlbnRIZWlnaHRzID0gW107XG5cbiAgICAgICAgICAgICAgICBfY2FwdGlvbi5lYWNoKCBmdW5jdGlvbigpIHtcblxuICAgICAgICAgICAgICAgICAgICB2YXIgaGVpZ2h0ID0gJCh0aGlzKS5pbm5lckhlaWdodCgpO1xuXG4gICAgICAgICAgICAgICAgICAgIF9jYXB0aW9uSGVpZ2h0cy5wdXNoKCBoZWlnaHQgKTtcblxuICAgICAgICAgICAgICAgIH0gKTtcblxuICAgICAgICAgICAgICAgIHZhciBtYXhIZWlnaHRDYXB0aW9uID0gTWF0aC5tYXguYXBwbHkoTWF0aCwgX2NhcHRpb25IZWlnaHRzKTtcblxuXG4gICAgICAgICAgICAgICAgX2NvbnRlbnQuZWFjaCggZnVuY3Rpb24oKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgdmFyIGhlaWdodCA9ICQodGhpcykuaW5uZXJIZWlnaHQoKTtcblxuICAgICAgICAgICAgICAgICAgICBfY29udGVudEhlaWdodHMucHVzaCggaGVpZ2h0ICk7XG5cbiAgICAgICAgICAgICAgICB9ICk7XG5cbiAgICAgICAgICAgICAgICB2YXIgbWF4SGVpZ2h0Q29udGVudCA9IE1hdGgubWF4LmFwcGx5KE1hdGgsIF9jb250ZW50SGVpZ2h0cyk7XG5cbiAgICAgICAgICAgICAgICBfY2FwdGlvbi5pbm5lckhlaWdodCggbWF4SGVpZ2h0Q2FwdGlvbiApO1xuICAgICAgICAgICAgICAgIF9jb250ZW50LmlubmVySGVpZ2h0KCBtYXhIZWlnaHRDb250ZW50ICk7XG5cbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBfaW5pdCA9IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgIF9vYmpbMF0ub2JqID0gX3NlbGY7XG4gICAgICAgICAgICAgICAgX2FkZEV2ZW50cygpO1xuICAgICAgICAgICAgfTtcblxuICAgICAgICBfaW5pdCgpO1xuICAgIH07XG5cbn0gKSgpO1xuIiwiXCJ1c2Ugc3RyaWN0XCI7XG4oIGZ1bmN0aW9uKCkge1xuXG4gICAgJCggZnVuY3Rpb24oKSB7XG5cbiAgICAgICAgJC5lYWNoKCAkKCcuY29uZmlybWF0aW9uJyksIGZ1bmN0aW9uICgpIHtcblxuICAgICAgICAgICAgbmV3IFBhc3RlRGF0YSggJCh0aGlzKSApO1xuXG4gICAgICAgIH0gKTtcblxuICAgIH0gKTtcblxuICAgIHZhciBQYXN0ZURhdGEgPSBmdW5jdGlvbiAob2JqKSB7XG5cbiAgICAgICAgLy9wcml2YXRlIHByb3BlcnRpZXNcbiAgICAgICAgdmFyIF9zZWxmID0gdGhpcyxcbiAgICAgICAgICAgIF9vYmogPSBvYmosXG4gICAgICAgICAgICBfY2hvc2VuRGF0YSA9IF9vYmouZmluZCgnLmNvbmZpcm1hdGlvbl9fZGF0YS1wYXN0ZScpLFxuICAgICAgICAgICAgX2RhdGFSYWRpbyxcbiAgICAgICAgICAgIF9kYXRhQ2hlY2tib3gsXG4gICAgICAgICAgICBfc3RyID0gJyc7XG5cbiAgICAgICAgLy9wcml2YXRlIG1ldGhvZHNcbiAgICAgICAgdmFyIF93cml0ZUluQmxvY2sgPSBmdW5jdGlvbigpIHtcblxuICAgICAgICAgICAgICAgIHZhciBkaXZSYXRlID0gJycsXG4gICAgICAgICAgICAgICAgICAgIG51bSA9ICcnLFxuICAgICAgICAgICAgICAgICAgICBhcnIgPSBbXTtcblxuICAgICAgICAgICAgICAgIGZvciggdmFyIGtleSBpbiBfZGF0YVJhZGlvICApIHtcblxuICAgICAgICAgICAgICAgICAgICB2YXIgaXRlbSA9IF9kYXRhUmFkaW9bIGtleSBdO1xuXG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgaWYoIF9kYXRhUmFkaW8ucmF0ZVBsYW4gIT0gdW5kZWZpbmVkICkge1xuXG4gICAgICAgICAgICAgICAgICAgICQuZWFjaCggX2RhdGFSYWRpby5yYXRlUGxhbiwgZnVuY3Rpb24oKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciB2YWx1ZSA9IF9kYXRhUmFkaW8ucmF0ZVBsYW4udmFsdWUuc3BsaXQoJyAnKTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgaWYoIF9kYXRhUmFkaW8ucmF0ZVBsYW4uc2Vzc2lvblR5cGUgPT09ICdzZXNzaW9uIHByaWNpbmcnICkge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZGl2UmF0ZSA9ICc8c3Bhbj4nKyBfZGF0YVJhZGlvLnJhdGVQbGFuLnNlc3Npb25UeXBlICsnICgnKyB2YWx1ZVswXSArJyBzZXNzaW9ucyk8L3NwYW4+JztcblxuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmKCBfZGF0YVJhZGlvLnJhdGVQbGFuLnNlc3Npb25UeXBlID09PSAnbWludXRlIHByaWNpbmcnICkge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIG1pbnV0ZXMgPSB2YWx1ZVswXS5yZXBsYWNlKC9bXjAtOV0rL2csJycpO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYoIG1pbnV0ZXMgPiAxMDAwMDAgKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbWludXRlcyA9IG1pbnV0ZXMvMTAwMDAwMCArICdNJ1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZGl2UmF0ZSA9ICc8c3Bhbj4nKyBfZGF0YVJhZGlvLnJhdGVQbGFuLnNlc3Npb25UeXBlICsnICgnKyBtaW51dGVzICsnIG1pbnV0ZXMgKCcgKyB2YWx1ZVsyXSArICcvbWludXRlKTwvc3Bhbj4nO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICB9XG5cblxuICAgICAgICAgICAgICAgICAgICB9ICk7XG5cbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBmb3IoIHZhciBrZXkxIGluIF9kYXRhQ2hlY2tib3ggICkge1xuXG4gICAgICAgICAgICAgICAgICAgIGFyci5wdXNoKGtleTEpXG5cbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBpZiggYXJyLmxlbmd0aCA+IDAgKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgaWYoIGFyci5sZW5ndGggPT0gMSApIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgbnVtID0gJysgJyArIGFyci5sZW5ndGggKyAnIHNlcnZpY2UnO1xuXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIG51bSA9ICcrICcgKyBhcnIubGVuZ3RoICsgJyBzZXJ2aWNlJztcblxuICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBfY2hvc2VuRGF0YS5odG1sKCdZb3UgY2hvc2UgJyArIGRpdlJhdGUgKyAnLCAnICsgaXRlbSArICcgJyArIG51bSArICcpLicpO1xuXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgX2dldFNlc3Npb25EYXRhID0gZnVuY3Rpb24oKSB7XG5cbiAgICAgICAgICAgICAgICBpZiggbG9jYWxTdG9yYWdlLnJhZGlvQ2hvb3NlICE9IHVuZGVmaW5lZCApIHtcblxuICAgICAgICAgICAgICAgICAgICBfZGF0YVJhZGlvID0gSlNPTi5wYXJzZSggbG9jYWxTdG9yYWdlLnJhZGlvQ2hvb3NlICk7XG4gICAgICAgICAgICAgICAgICAgIF9kYXRhQ2hlY2tib3ggPSBKU09OLnBhcnNlKCBsb2NhbFN0b3JhZ2UuY2hlY2tib3hDaG9vc2UgKTtcblxuICAgICAgICAgICAgICAgICAgICBfd3JpdGVJbkJsb2NrKCk7XG5cbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuXG4gICAgICAgICAgICAgICAgICAgIHdpbmRvdy5sb2NhdGlvbi5ocmVmID0gJCgnYm9keScpLmRhdGEoJ3NyYycpO1xuXG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgX2luaXQgPSBmdW5jdGlvbiAoKSB7XG5cbiAgICAgICAgICAgICAgICBfb2JqWzBdLm9iaiA9IF9zZWxmO1xuICAgICAgICAgICAgICAgIF9nZXRTZXNzaW9uRGF0YSgpO1xuICAgICAgICAgICAgfTtcblxuICAgICAgICBfaW5pdCgpO1xuICAgIH07XG5cbn0gKSgpO1xuIl0sInNvdXJjZVJvb3QiOiIvc291cmNlLyJ9
