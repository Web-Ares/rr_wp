"use strict";!function(){$(function(){$.each($(".clouds"),function(){new t($(this))}),$.each($(".guy"),function(){new n($(this))}),$.each($(".site__content_full"),function(){new i($(this))}),$.each($(".plans"),function(){new s($(this))})});var t=function(t){var n=this,i=t,s=i,o=$(window),a=(o.width(),function(){o.on({resize:function(){h(),e()},load:function(){e()},scroll:function(){e()}})}),e=function(){var t,n=i.offset().top,s=n-o.height(),a=n+i.height(),e=(a-o.scrollTop())/(a-s);e>1?t=0:e<0&&(t=1),e<1&&e>0&&(t=1-e),i.hasClass("putted-all")&&(t=.5),r(s,a,t)},r=function(t,n,i){s.each(function(){var t=$(this),n=100,s=1;t.hasClass("clouds_1")&&(s=-1),0==i?t.css({"-webkit-transform":"translateX("+-n*s+"%)",transform:"translateX("+-n*s+"%)"}):1==i?t.css({"-webkit-transform":"translateX("+-n*s+"%)",transform:"translateX("+-n*s+"%)"}):(i>=.5&&(i=1-i),t.css({"-webkit-transform":"translateX("+200*i*s+"%)",transform:"translateX("+200*i*s+"%)"}))})},h=function(){var t=o.height(),n=$(".site").height();n<=t?i.addClass("putted-all"):i.removeClass("putted-all")},f=function(){i[0].obj=n,a(),h()};f()},n=function(t){var n=this,i=t,s=i.find(".guy__hand"),o=$(window),a=o.width(),e=function(){o.on({resize:function(){a!=o.width()&&(a=o.width()+1,o.width()<768&&s.css({"-webkit-transform":"none",transform:"none"})),f(),h(),r()},load:function(){o.width()>=768&&r()},scroll:function(){o.width()>=768&&r()}})},r=function(){var t,n=o.height(),a=i.offset().top,e=s.offset().top-n,r=a-n+i.height();i.hasClass("putted")&&(e=s.offset().top-n/2,r=n/2.5);var h=(r-o.scrollTop())/(r-e);h>1?t=0:h<0&&(t=1),h<1&&h>0&&(t=1-h),i.hasClass("putted-all")&&(t=1),c(e,r,t)},h=function(){var t=o.height(),n=o.scrollTop(),a=s.height(),e=s.offset().top;a+e<t+n&&$(".site").height()>2*t?i.addClass("putted"):i.removeClass("putted")},f=function(){var t=o.height(),n=$(".site").height();n<=t?i.addClass("putted-all"):i.removeClass("putted-all")},c=function(t,n,i){var a=n-t;s.each(function(){var n=$(this),s=n.data("rotate-start"),e=n.data("rotate-finish"),r=s+(e-s)/a*(o.scrollTop()-t);1==i?n.css({"-webkit-transform":"rotate( "+-e+"deg )",transform:"rotate( "+-e+"deg )"}):0==i?n.css({"-webkit-transform":"rotate( "+-s+"deg )",transform:"rotate( "+-s+"deg )"}):n.css({"-webkit-transform":"rotate( "+-r+"deg )",transform:"rotate( "+-r+"deg )"})})},u=function(){i[0].obj=n,e(),h(),f()};u()},i=function(t){var n=this,i=t,s=$(window),o=$(".site__header"),a=function(){s.on({resize:function(){e()}})},e=function(){var t=o.height();i.height(s.height()-t),i.css({"min-height":i.find(">div:first").height()})},r=function(){i[0].obj=n,a(),e()};r()},s=function(t){var n=this,i=t,s=$(window),o=i.find(".plans__list_caption"),a=i.find(".plans__list-row:not(.plans__list_caption)"),e=[],r=[],h=function(){s.on({load:function(){s.width()>=1024&&f()},resize:function(){s.width()<1024?(o.css({height:""}),a.css({height:""})):f()}})},f=function(){e=[],r=[],o.each(function(){var t=$(this).innerHeight();e.push(t)});var t=Math.max.apply(Math,e);a.each(function(){var t=$(this).innerHeight();r.push(t)});var n=Math.max.apply(Math,r);o.innerHeight(t),a.innerHeight(n)},c=function(){i[0].obj=n,h()};c()}}();
"use strict";!function(){$(function(){$.each($(".choose-data"),function(){new t($(this))}),$.each($(".order"),function(){new a($(this))}),$.each($(".plans"),function(){new e($(this))})});var t=function(t){var a=this,e=t,n=e.find(".choose-data__items"),i=n.find("input"),r=e.find(".btn_next"),o={},s={},c={},l=function(){i.on({click:function(){f($(this)),v(),localStorage.setItem("idItems",JSON.stringify(c))}}),r.on({click:function(){var t=$(this),a=t.data("src");return h(),window.location.href=a,!1}})},f=function(t){var a=t;"radio"===a.attr("type")?(a.parents(".plans").length?o.ratePlan={sessionType:a.data("rate"),value:a.attr("value")}:o[a.attr("name")]=a.attr("value"),c[a.attr("name")]=a.attr("id")):"checkbox"===a.attr("type")&&(a.is(":checked")?(s[a.attr("name")]=a.attr("value"),c[a.attr("name")]=a.attr("id")):(delete s[a.attr("name")],delete c[a.attr("name")]))},d=function(){if(void 0!=localStorage.idItems){i.each(function(){var t=$(this);"checkbox"===t.attr("type")&&t.prop("checked",!1)});var t=JSON.parse(localStorage.idItems);for(var a in t){var e=t[a];i.filter("#"+e).prop("checked",!0)}}},h=function(){i.each(function(){var t=$(this);t.is(":checked")&&("radio"===t.attr("type")?c[t.attr("name")]=t.attr("id"):"checkbox"===t.attr("type")&&(t.is(":checked")?c[t.attr("name")]=t.attr("id"):delete c[t.attr("name")]))}),localStorage.setItem("idItems",JSON.stringify(c))},u=function(){i.each(function(){var t=$(this);t.is(":checked")&&("radio"===t.attr("type")?t.parents(".plans").length?o.ratePlan={sessionType:t.data("rate"),value:t.attr("value")}:o[t.attr("name")]=t.attr("value"):"checkbox"===t.attr("type")&&(t.is(":checked")?s[t.attr("name")]=t.attr("value"):delete s[t.attr("name")]))}),v()},v=function(){localStorage.setItem("radioChoose",JSON.stringify(o)),localStorage.setItem("checkboxChoose",JSON.stringify(s))},p=function(){e[0].obj=a,l(),d(),u()};p()},a=function(t){var a,e,n=this,i=t,r=i.find(".order__chosen-data span"),o=i.find("input#input_1_5"),s="",c=function(){},l=function(){var t="",n="",i=[];for(var o in a)var s=a[o];void 0!=a.ratePlan&&$.each(a.ratePlan,function(){var e=a.ratePlan.value.split(" ");if("session pricing"===a.ratePlan.sessionType)t="<span>"+a.ratePlan.sessionType+" ("+e[0]+" sessions)</span>";else if("minute pricing"===a.ratePlan.sessionType){var n=e[0].replace(/[^0-9]+/g,"");n>1e5&&(n=n/1e6+"M"),t="<span>"+a.ratePlan.sessionType+" ("+n+" minutes ("+e[2]+"/minute)</span>"}});for(var c in e)i.push(c);i.length>0&&(n=1==i.length?"+ "+i.length+" service":"+ "+i.length+" service"),r.html("You chose "+t+", "+s+" "+n+").")},f=function(){s="";for(var t in a){var n=a[t];if("string"==typeof n)s+=""+n+"; ";else if("object"==typeof n)for(var i in n){var r=n[i];s+=""+r+"; "}}for(var c in e){var l=e[c];s+=""+l+"; "}o.val(s)},d=function(){void 0!=localStorage.radioChoose?(a=JSON.parse(localStorage.radioChoose),e=JSON.parse(localStorage.checkboxChoose),f(),l()):window.location.href=$("body").data("src")},h=function(){i[0].obj=n,c(),d()};h()},e=function(t){var a=this,e=t,n=e.find(".plans__item"),i=e.find('input[type="radio"]'),r=$(window),o=function(){r.on({load:function(){s()}}),i.on({change:function(){var t=$(this),a=t.parents(".plans__item");a.hasClass("active")||(n.removeClass("active"),a.addClass("active"))}}),n.on({click:function(){var t=$(this),a=t.find('input[type="radio"]:first');t.hasClass("active")||(n.removeClass("active"),t.addClass("active"),a.trigger("click"))}})},s=function(){var t=i.filter(":checked"),a=t.parents(".plans__item");a.addClass("active")},c=function(){e[0].obj=a,o()};c()}}();
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImpxdWVyeS5tYWluLmpzIiwianF1ZXJ5LmNoZWNrb3V0LmpzIl0sIm5hbWVzIjpbIiQiLCJlYWNoIiwiQ2xvdWRzQW5pbWF0ZWQiLCJ0aGlzIiwiR3V5QW5pbWF0ZWQiLCJDb250ZW50RnVsbEhlaWdodCIsIlBsYW5zQ2hvb3NlSGVpZ2h0Iiwib2JqIiwiX3NlbGYiLCJfb2JqIiwiX2l0ZW1zIiwiX3dpbmRvdyIsIndpbmRvdyIsIl9hZGRFdmVudHMiLCJ3aWR0aCIsIm9uIiwicmVzaXplIiwiX2NoZWNrUHV0SW5XaW5kb3ciLCJfY2hlY2tTY3JvbGwiLCJsb2FkIiwic2Nyb2xsIiwic2Nyb2xsUG9pbnQiLCJ0b3BQb3MiLCJvZmZzZXQiLCJ0b3AiLCJzdGFydCIsImhlaWdodCIsImVuZCIsIngiLCJzY3JvbGxUb3AiLCJoYXNDbGFzcyIsIl9hbmltYXRpb25FbGVtcyIsInN0YXJ0UG9pbnQiLCJlbmRQb2ludCIsImN1ckVsZW0iLCJ0cmFuc2xhdGVGaW5pc2giLCJjc3MiLCItd2Via2l0LXRyYW5zZm9ybSIsInRyYW5zZm9ybSIsImhlaWdodFdpbiIsImhlaWdodFNpdGUiLCJhZGRDbGFzcyIsInJlbW92ZUNsYXNzIiwiX2luaXQiLCJfaGFuZCIsImZpbmQiLCJfZ2xvYmFsV2lkdGgiLCJfY2hlY2tHZXRJbldpbmRvdyIsIndpbmRvd0giLCJzY3JvbGxUb3BXaW4iLCJoZWlnaHRPYmoiLCJwb3NpdGlvbk9iaiIsInNlZ21lbnQiLCJyb3RhdGVTdGFydCIsImRhdGEiLCJyb3RhdGVGaW5pc2giLCJrb2ZSb3RhdGUiLCJfaGVhZGVyIiwiX3NldEhlaWdodCIsImhlYWRlckhlaWd0aCIsIm1pbi1oZWlnaHQiLCJfY2FwdGlvbiIsIl9jb250ZW50IiwiX2NhcHRpb25IZWlnaHRzIiwiX2NvbnRlbnRIZWlnaHRzIiwiaW5uZXJIZWlnaHQiLCJwdXNoIiwibWF4SGVpZ2h0Q2FwdGlvbiIsIk1hdGgiLCJtYXgiLCJhcHBseSIsIm1heEhlaWdodENvbnRlbnQiLCJDaG9vc2VEYXRhIiwiUGFzdGVEYXRhIiwiRGF0ZVBsYW4iLCJfaW5wdXQiLCJfcmVkaXJlY3RCdG4iLCJfZGF0YVJhZGlvIiwiX2RhdGFDaGVja2JveCIsIl9pZEl0ZW1zIiwiY2xpY2siLCJfZ2V0RGF0YSIsIl93cml0ZUluU2Vzc2lvblN0b3JhZ2UiLCJsb2NhbFN0b3JhZ2UiLCJzZXRJdGVtIiwiSlNPTiIsInN0cmluZ2lmeSIsImN1ckl0ZW0iLCJkYXRhU3JjIiwiX3dyaXRlQWxsSWQiLCJsb2NhdGlvbiIsImhyZWYiLCJlbGVtIiwiYXR0ciIsInBhcmVudHMiLCJsZW5ndGgiLCJyYXRlUGxhbiIsInNlc3Npb25UeXBlIiwidmFsdWUiLCJpcyIsIl9zZXRDaGVja2VkTmVlZElucHV0IiwidW5kZWZpbmVkIiwiaWRJdGVtcyIsInByb3AiLCJhbGxJZCIsInBhcnNlIiwia2V5IiwiaXRlbSIsImZpbHRlciIsIl93cml0ZURhdGFJbk9iakFmdGVyTG9hZCIsIl9jaG9zZW5EYXRhIiwiX3N0ciIsIl93cml0ZUluQmxvY2siLCJkaXZSYXRlIiwibnVtIiwiYXJyIiwic3BsaXQiLCJtaW51dGVzIiwicmVwbGFjZSIsImtleTEiLCJodG1sIiwiX3dyaXRlSW5IaWRkZW4iLCJpdGVtMSIsImtleTMiLCJpdGVtMyIsInZhbCIsIl9nZXRTZXNzaW9uRGF0YSIsInJhZGlvQ2hvb3NlIiwiY2hlY2tib3hDaG9vc2UiLCJfcmFkaW8iLCJfc2V0QWN0aXZlQ2xhc3MiLCJjaGFuZ2UiLCJwYXJlbnQiLCJmaXJzdFJhZGlvIiwidHJpZ2dlciIsImFjdGl2ZVJhZGlvIl0sIm1hcHBpbmdzIjoiQUFBQSxjQUNBLFdBRUlBLEVBQUcsV0FFQ0EsRUFBRUMsS0FBTUQsRUFBRSxXQUFZLFdBRWxCLEdBQUlFLEdBQWdCRixFQUFFRyxTQUkxQkgsRUFBRUMsS0FBTUQsRUFBRSxRQUFTLFdBRWYsR0FBSUksR0FBYUosRUFBRUcsU0FJdkJILEVBQUVDLEtBQU1ELEVBQUUsdUJBQXdCLFdBRTlCLEdBQUlLLEdBQW1CTCxFQUFFRyxT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LEVBQU8zRixTQUFTLGNBTzVCL0IsRUFBT0ssSUFDSGlFLE1BQU8sV0FFSCxHQUFJTyxHQUFVdkYsRUFBRUcsTUFDWmtJLEVBQWE5QyxFQUFRMUMsS0FBSyw0QkFFdkIwQyxHQUFRekQsU0FBUyxZQUVwQnBCLEVBQU9nQyxZQUFZLFVBQ25CNkMsRUFBUTlDLFNBQVMsVUFDakI0RixFQUFXQyxRQUFRLGNBUW5DSixFQUFrQixXQUVkLEdBQUlLLEdBQWNOLEVBQU9yQixPQUFPLFlBQzVCd0IsRUFBU0csRUFBWXpDLFFBQVEsZUFFN0JzQyxHQUFPM0YsU0FBUyxXQUd4QkUsRUFBUSxXQUVKbEMsRUFBSyxHQUFHRixJQUFNQyxFQUNkSyxJQUdSOEIiLCJmaWxlIjoiY2hlY2tvdXQubWluLmpzIiwic291cmNlc0NvbnRlbnQiOlsiXCJ1c2Ugc3RyaWN0XCI7XG4oIGZ1bmN0aW9uKCkge1xuXG4gICAgJCggZnVuY3Rpb24oKSB7XG5cbiAgICAgICAgJC5lYWNoKCAkKCcuY2xvdWRzJyksIGZ1bmN0aW9uICgpIHtcblxuICAgICAgICAgICAgbmV3IENsb3Vkc0FuaW1hdGVkKCAkKHRoaXMpICk7XG5cbiAgICAgICAgfSApO1xuXG4gICAgICAgICQuZWFjaCggJCgnLmd1eScpLCBmdW5jdGlvbiAoKSB7XG5cbiAgICAgICAgICAgIG5ldyBHdXlBbmltYXRlZCggJCh0aGlzKSApO1xuXG4gICAgICAgIH0gKTtcblxuICAgICAgICAkLmVhY2goICQoJy5zaXRlX19jb250ZW50X2Z1bGwnKSwgZnVuY3Rpb24gKCkge1xuXG4gICAgICAgICAgICBuZXcgQ29udGVudEZ1bGxIZWlnaHQoICQodGhpcykgKTtcblxuICAgICAgICB9ICk7XG5cbiAgICAgICAgJC5lYWNoKCAkKCcucGxhbnMnKSwgZnVuY3Rpb24gKCkge1xuXG4gICAgICAgICAgICBuZXcgUGxhbnNDaG9vc2VIZWlnaHQoICQodGhpcykgKTtcblxuICAgICAgICB9ICk7XG5cbiAgICB9ICk7XG5cbiAgICB2YXIgQ2xvdWRzQW5pbWF0ZWQgPSBmdW5jdGlvbiAob2JqKSB7XG5cbiAgICAgICAgLy9wcml2YXRlIHByb3BlcnRpZXNcbiAgICAgICAgdmFyIF9zZWxmID0gdGhpcyxcbiAgICAgICAgICAgIF9vYmogPSBvYmosXG4gICAgICAgICAgICBfaXRlbXMgPSBfb2JqLFxuICAgICAgICAgICAgX3dpbmRvdyA9ICQod2luZG93KSxcbiAgICAgICAgICAgIF9nbG9iYWxXaWR0aCA9IF93aW5kb3cud2lkdGgoKTtcblxuICAgICAgICAvL3ByaXZhdGUgbWV0aG9kc1xuICAgICAgICB2YXIgX2FkZEV2ZW50cyA9IGZ1bmN0aW9uICgpIHtcblxuICAgICAgICAgICAgICAgIF93aW5kb3cub24oIHtcbiAgICAgICAgICAgICAgICAgICAgcmVzaXplOiBmdW5jdGlvbigpIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgX2NoZWNrUHV0SW5XaW5kb3coKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIF9jaGVja1Njcm9sbCgpO1xuXG4gICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgIGxvYWQ6IGZ1bmN0aW9uKCkge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICBfY2hlY2tTY3JvbGwoKTtcblxuICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICBzY3JvbGw6IGZ1bmN0aW9uICgpIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgX2NoZWNrU2Nyb2xsKCk7XG5cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0gKTtcblxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIF9jaGVja1Njcm9sbCA9IGZ1bmN0aW9uKCl7XG5cbiAgICAgICAgICAgICAgICB2YXIgdG9wUG9zID0gX29iai5vZmZzZXQoKS50b3AgLFxuICAgICAgICAgICAgICAgICAgICBzdGFydCA9IHRvcFBvcyAtIF93aW5kb3cuaGVpZ2h0KCksXG4gICAgICAgICAgICAgICAgICAgIGVuZCA9IHRvcFBvcyArIF9vYmouaGVpZ2h0KCksXG4gICAgICAgICAgICAgICAgICAgIHNjcm9sbFBvaW50O1xuXG4gICAgICAgICAgICAgICAgdmFyIHggPSAoIGVuZCAtIF93aW5kb3cuc2Nyb2xsVG9wKCkgKSAvICggZW5kIC0gIHN0YXJ0ICk7XG5cbiAgICAgICAgICAgICAgICBpZiAoIHggPiAxICkge1xuXG4gICAgICAgICAgICAgICAgICAgIHNjcm9sbFBvaW50ID0gMDtcblxuXG4gICAgICAgICAgICAgICAgfSBlbHNlIGlmICggeCA8IDAgKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgc2Nyb2xsUG9pbnQgPSAxO1xuXG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgaWYoICggeCA8IDEgKSAmJiAoIHggPiAwICkgKXtcblxuICAgICAgICAgICAgICAgICAgICBzY3JvbGxQb2ludCA9IDEgLSB4O1xuXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmKCAgX29iai5oYXNDbGFzcygncHV0dGVkLWFsbCcpICkge1xuXG4gICAgICAgICAgICAgICAgICAgIHNjcm9sbFBvaW50ID0gMC41O1xuXG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgX2FuaW1hdGlvbkVsZW1zKCBzdGFydCwgZW5kLCBzY3JvbGxQb2ludCApO1xuXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgX2FuaW1hdGlvbkVsZW1zID0gZnVuY3Rpb24gKCBzdGFydFBvaW50LCBlbmRQb2ludCwgc2Nyb2xsUG9pbnQgKSB7XG5cbiAgICAgICAgICAgICAgICBfaXRlbXMuZWFjaCggZnVuY3Rpb24gKCkge1xuXG4gICAgICAgICAgICAgICAgICAgIHZhciBjdXJFbGVtID0gJCggdGhpcyApLFxuICAgICAgICAgICAgICAgICAgICAgICAgdHJhbnNsYXRlU3RhcnQgPSAwLFxuICAgICAgICAgICAgICAgICAgICAgICAgdHJhbnNsYXRlRmluaXNoID0gMTAwLFxuICAgICAgICAgICAgICAgICAgICAgICAgeCA9IDE7XG5cbiAgICAgICAgICAgICAgICAgICAgaWYoIGN1ckVsZW0uaGFzQ2xhc3MoJ2Nsb3Vkc18xJykgKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIHggPSAtMTtcblxuICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgaWYgKCBzY3JvbGxQb2ludCA9PSAwICkge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICBjdXJFbGVtLmNzcygge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJy13ZWJraXQtdHJhbnNmb3JtJzogJ3RyYW5zbGF0ZVgoJyArKCAtdHJhbnNsYXRlRmluaXNoICogeCApKyAnJSknLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICd0cmFuc2Zvcm0nOiAndHJhbnNsYXRlWCgnICsoIC10cmFuc2xhdGVGaW5pc2ggKiB4ICkrICclKSdcblxuICAgICAgICAgICAgICAgICAgICAgICAgfSApO1xuXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoIHNjcm9sbFBvaW50ID09IDEgKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIGN1ckVsZW0uY3NzKCB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAnLXdlYmtpdC10cmFuc2Zvcm0nOiAndHJhbnNsYXRlWCgnICsoIC10cmFuc2xhdGVGaW5pc2ggKiB4ICkrICclKScsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJ3RyYW5zZm9ybSc6ICd0cmFuc2xhdGVYKCcgKyggLXRyYW5zbGF0ZUZpbmlzaCAqIHggKSsgJyUpJ1xuXG4gICAgICAgICAgICAgICAgICAgICAgICB9ICk7XG5cbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcblxuXG4gICAgICAgICAgICAgICAgICAgICAgICAvL2lmKCBzY3JvbGxQb2ludCA8IDAuNSAmJiBzY3JvbGxQb2ludCA+IDAgKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAvL1xuICAgICAgICAgICAgICAgICAgICAgICAgLy8gICAgY3VyRWxlbS5jc3MoIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyAgICAgICAgJy13ZWJraXQtdHJhbnNmb3JtJzogJ3RyYW5zbGF0ZVgoJyArKCBzY3JvbGxQb2ludCAqIDIwMCAqIHggKSsgJyUpJyxcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vICAgICAgICAndHJhbnNmb3JtJzogJ3RyYW5zbGF0ZVgoJyArKCBzY3JvbGxQb2ludCAqIDIwMCAqIHggKSsgJyUpJ1xuICAgICAgICAgICAgICAgICAgICAgICAgLy9cbiAgICAgICAgICAgICAgICAgICAgICAgIC8vICAgIH0gKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vXG4gICAgICAgICAgICAgICAgICAgICAgICAvL31cbiAgICAgICAgICAgICAgICAgICAgICAgIC8vXG4gICAgICAgICAgICAgICAgICAgICAgICAvL1xuICAgICAgICAgICAgICAgICAgICAgICAgLy9pZiggc2Nyb2xsUG9pbnQgPj0gMC41ICYmIHNjcm9sbFBvaW50IDwgMC44ICkge1xuICAgICAgICAgICAgICAgICAgICAgICAgLy9cbiAgICAgICAgICAgICAgICAgICAgICAgIC8vICAgIGN1ckVsZW0uY3NzKCB7XG4gICAgICAgICAgICAgICAgICAgICAgICAvL1xuICAgICAgICAgICAgICAgICAgICAgICAgLy8gICAgICAgICctd2Via2l0LXRyYW5zZm9ybSc6ICd0cmFuc2xhdGVYKCcgKyggdHJhbnNsYXRlRmluaXNoICogeCApKyAnJSknLFxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gICAgICAgICd0cmFuc2Zvcm0nOiAndHJhbnNsYXRlWCgnICsoIHRyYW5zbGF0ZUZpbmlzaCAqIHggKSsgJyUpJ1xuICAgICAgICAgICAgICAgICAgICAgICAgLy9cbiAgICAgICAgICAgICAgICAgICAgICAgIC8vICAgIH0gKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vXG4gICAgICAgICAgICAgICAgICAgICAgICAvL31cbiAgICAgICAgICAgICAgICAgICAgICAgIC8vXG4gICAgICAgICAgICAgICAgICAgICAgICAvL2lmKCBzY3JvbGxQb2ludCA+PSAwLjggKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAvL1xuICAgICAgICAgICAgICAgICAgICAgICAgLy8gICAgc2Nyb2xsUG9pbnQgPSAxLjMgLSBzY3JvbGxQb2ludDtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyAgICBjdXJFbGVtLmNzcygge1xuICAgICAgICAgICAgICAgICAgICAgICAgLy9cbiAgICAgICAgICAgICAgICAgICAgICAgIC8vICAgICAgICAnLXdlYmtpdC10cmFuc2Zvcm0nOiAndHJhbnNsYXRlWCgnICsoIHNjcm9sbFBvaW50ICogMjAwICogeCApKyAnJSknLFxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gICAgICAgICd0cmFuc2Zvcm0nOiAndHJhbnNsYXRlWCgnICsoIHNjcm9sbFBvaW50ICogMjAwICogeCApKyAnJSknXG4gICAgICAgICAgICAgICAgICAgICAgICAvL1xuICAgICAgICAgICAgICAgICAgICAgICAgLy8gICAgfSApO1xuICAgICAgICAgICAgICAgICAgICAgICAgLy9cbiAgICAgICAgICAgICAgICAgICAgICAgIC8vfVxuXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiggc2Nyb2xsUG9pbnQgPj0gMC41ICkge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc2Nyb2xsUG9pbnQgPSAxIC0gc2Nyb2xsUG9pbnQ7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAgICAgY3VyRWxlbS5jc3MoIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICctd2Via2l0LXRyYW5zZm9ybSc6ICd0cmFuc2xhdGVYKCcgKyggc2Nyb2xsUG9pbnQgKiAyMDAgKiB4ICkrICclKScsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJ3RyYW5zZm9ybSc6ICd0cmFuc2xhdGVYKCcgKyggc2Nyb2xsUG9pbnQgKiAyMDAgKiB4ICkrICclKSdcblxuICAgICAgICAgICAgICAgICAgICAgICAgfSApO1xuXG5cbiAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgfSApO1xuXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgX2NoZWNrUHV0SW5XaW5kb3cgPSBmdW5jdGlvbigpIHtcblxuICAgICAgICAgICAgICAgIHZhciBoZWlnaHRXaW4gPSBfd2luZG93LmhlaWdodCgpLFxuICAgICAgICAgICAgICAgICAgICBoZWlnaHRTaXRlID0gJCgnLnNpdGUnKS5oZWlnaHQoKTtcblxuICAgICAgICAgICAgICAgIGlmKCBoZWlnaHRTaXRlIDw9IGhlaWdodFdpbiApIHtcblxuICAgICAgICAgICAgICAgICAgICBfb2JqLmFkZENsYXNzKCdwdXR0ZWQtYWxsJyk7XG5cbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuXG4gICAgICAgICAgICAgICAgICAgIF9vYmoucmVtb3ZlQ2xhc3MoJ3B1dHRlZC1hbGwnKTtcblxuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIF9pbml0ID0gZnVuY3Rpb24gKCkge1xuXG4gICAgICAgICAgICAgICAgX29ialswXS5vYmogPSBfc2VsZjtcbiAgICAgICAgICAgICAgICBfYWRkRXZlbnRzKCk7XG4gICAgICAgICAgICAgICAgX2NoZWNrUHV0SW5XaW5kb3coKTtcblxuICAgICAgICAgICAgfTtcblxuICAgICAgICBfaW5pdCgpO1xuICAgIH07XG5cbiAgICB2YXIgR3V5QW5pbWF0ZWQgPSBmdW5jdGlvbiAob2JqKSB7XG5cbiAgICAgICAgLy9wcml2YXRlIHByb3BlcnRpZXNcbiAgICAgICAgdmFyIF9zZWxmID0gdGhpcyxcbiAgICAgICAgICAgIF9vYmogPSBvYmosXG4gICAgICAgICAgICBfaGFuZCA9IF9vYmouZmluZCgnLmd1eV9faGFuZCcpLFxuICAgICAgICAgICAgX3dpbmRvdyA9ICQod2luZG93KSxcbiAgICAgICAgICAgIF9nbG9iYWxXaWR0aCA9IF93aW5kb3cud2lkdGgoKTtcblxuICAgICAgICAvL3ByaXZhdGUgbWV0aG9kc1xuICAgICAgICB2YXIgX2FkZEV2ZW50cyA9IGZ1bmN0aW9uICgpIHtcblxuICAgICAgICAgICAgICAgIF93aW5kb3cub24oIHtcbiAgICAgICAgICAgICAgICAgICAgcmVzaXplOiBmdW5jdGlvbigpIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgaWYoIF9nbG9iYWxXaWR0aCAhPSBfd2luZG93LndpZHRoKCkgKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBfZ2xvYmFsV2lkdGggPSBfd2luZG93LndpZHRoKCkgKyAxO1xuXG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiggX3dpbmRvdy53aWR0aCgpIDwgNzY4ICkge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9oYW5kLmNzcygge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJy13ZWJraXQtdHJhbnNmb3JtJzogJ25vbmUnLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ3RyYW5zZm9ybSc6ICdub25lJ1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9ICk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAgICAgX2NoZWNrUHV0SW5XaW5kb3coKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIF9jaGVja0dldEluV2luZG93KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBfY2hlY2tTY3JvbGwoKTtcblxuICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICBsb2FkOiBmdW5jdGlvbigpIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgaWYoIF93aW5kb3cud2lkdGgoKSA+PSA3NjggKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBfY2hlY2tTY3JvbGwoKTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgIHNjcm9sbDogZnVuY3Rpb24gKCkge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoX3dpbmRvdy53aWR0aCgpID49IDc2OCkge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgX2NoZWNrU2Nyb2xsKCk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSApO1xuXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgX2NoZWNrU2Nyb2xsID0gZnVuY3Rpb24oKSB7XG5cbiAgICAgICAgICAgICAgICB2YXIgd2luZG93SCA9IF93aW5kb3cuaGVpZ2h0KCksXG4gICAgICAgICAgICAgICAgICAgIHRvcFBvcyA9IF9vYmoub2Zmc2V0KCkudG9wLFxuICAgICAgICAgICAgICAgICAgICBzdGFydCA9IF9oYW5kLm9mZnNldCgpLnRvcCAtIHdpbmRvd0gsXG4gICAgICAgICAgICAgICAgICAgIGVuZCA9IHRvcFBvcyAtIHdpbmRvd0ggKyBfb2JqLmhlaWdodCgpLFxuICAgICAgICAgICAgICAgICAgICBzY3JvbGxQb2ludDtcblxuICAgICAgICAgICAgICAgIGlmKCAgX29iai5oYXNDbGFzcygncHV0dGVkJykgKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgc3RhcnQgPSBfaGFuZC5vZmZzZXQoKS50b3AgLSB3aW5kb3dILzI7XG4gICAgICAgICAgICAgICAgICAgIGVuZCA9IHdpbmRvd0gvMi41O1xuXG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgdmFyIHggPSAoIGVuZCAtIF93aW5kb3cuc2Nyb2xsVG9wKCkgKSAvICggZW5kIC0gIHN0YXJ0ICk7XG5cbiAgICAgICAgICAgICAgICBpZiAoIHggPiAxICkge1xuXG4gICAgICAgICAgICAgICAgICAgIHNjcm9sbFBvaW50ID0gMDtcblxuXG4gICAgICAgICAgICAgICAgfSBlbHNlIGlmICggeCA8IDAgKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgc2Nyb2xsUG9pbnQgPSAxO1xuXG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgaWYoICggeCA8IDEgKSAmJiAoIHggPiAwICkgKXtcblxuICAgICAgICAgICAgICAgICAgICBzY3JvbGxQb2ludCA9IDEgLSB4O1xuXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmKCAgX29iai5oYXNDbGFzcygncHV0dGVkLWFsbCcpICkge1xuXG4gICAgICAgICAgICAgICAgICAgIHNjcm9sbFBvaW50ID0gMTtcblxuICAgICAgICAgICAgICAgIH1cblxuXG4gICAgICAgICAgICAgICAgX2FuaW1hdGlvbkVsZW1zKCBzdGFydCwgZW5kLCBzY3JvbGxQb2ludCApO1xuXG5cbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBfY2hlY2tHZXRJbldpbmRvdyA9IGZ1bmN0aW9uKCkge1xuXG4gICAgICAgICAgICAgICAgdmFyIGhlaWdodFdpbiA9IF93aW5kb3cuaGVpZ2h0KCksXG4gICAgICAgICAgICAgICAgICAgIHNjcm9sbFRvcFdpbiA9X3dpbmRvdy5zY3JvbGxUb3AoKSxcbiAgICAgICAgICAgICAgICAgICAgaGVpZ2h0T2JqID0gX2hhbmQuaGVpZ2h0KCksXG4gICAgICAgICAgICAgICAgICAgIHBvc2l0aW9uT2JqID0gX2hhbmQub2Zmc2V0KCkudG9wO1xuXG4gICAgICAgICAgICAgICAgaWYoICggaGVpZ2h0T2JqICsgcG9zaXRpb25PYmogPCBoZWlnaHRXaW4gKyBzY3JvbGxUb3BXaW4gKSAmJiAkKCcuc2l0ZScpLmhlaWdodCgpID4gaGVpZ2h0V2luICogMiAgKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgX29iai5hZGRDbGFzcygncHV0dGVkJyk7XG5cbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuXG4gICAgICAgICAgICAgICAgICAgIF9vYmoucmVtb3ZlQ2xhc3MoJ3B1dHRlZCcpO1xuXG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgX2NoZWNrUHV0SW5XaW5kb3cgPSBmdW5jdGlvbigpIHtcblxuICAgICAgICAgICAgICAgIHZhciBoZWlnaHRXaW4gPSBfd2luZG93LmhlaWdodCgpLFxuICAgICAgICAgICAgICAgICAgICBoZWlnaHRTaXRlID0gJCgnLnNpdGUnKS5oZWlnaHQoKTtcblxuICAgICAgICAgICAgICAgIGlmKCBoZWlnaHRTaXRlIDw9IGhlaWdodFdpbiApIHtcblxuICAgICAgICAgICAgICAgICAgICBfb2JqLmFkZENsYXNzKCdwdXR0ZWQtYWxsJyk7XG5cbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuXG4gICAgICAgICAgICAgICAgICAgIF9vYmoucmVtb3ZlQ2xhc3MoJ3B1dHRlZC1hbGwnKTtcblxuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIF9hbmltYXRpb25FbGVtcyA9IGZ1bmN0aW9uICggc3RhcnRQb2ludCwgZW5kUG9pbnQsIHNjcm9sbFBvaW50ICkge1xuXG4gICAgICAgICAgICAgICAgdmFyIHNlZ21lbnQgPSBlbmRQb2ludCAtIHN0YXJ0UG9pbnQ7XG5cbiAgICAgICAgICAgICAgICBfaGFuZC5lYWNoKCBmdW5jdGlvbiAoKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgdmFyIGN1ckVsZW0gPSAkKCB0aGlzICksXG4gICAgICAgICAgICAgICAgICAgICAgICByb3RhdGVTdGFydCA9IGN1ckVsZW0uZGF0YSgncm90YXRlLXN0YXJ0JyksXG4gICAgICAgICAgICAgICAgICAgICAgICByb3RhdGVGaW5pc2ggPSBjdXJFbGVtLmRhdGEoJ3JvdGF0ZS1maW5pc2gnKSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGtvZlJvdGF0ZSA9IHJvdGF0ZVN0YXJ0ICsgKCByb3RhdGVGaW5pc2ggLSByb3RhdGVTdGFydCApIC8gc2VnbWVudCAqICggX3dpbmRvdy5zY3JvbGxUb3AoKSAtIHN0YXJ0UG9pbnQgKTtcblxuICAgICAgICAgICAgICAgICAgICBpZiAoIHNjcm9sbFBvaW50ID09IDEgKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIGN1ckVsZW0uY3NzKCB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJy13ZWJraXQtdHJhbnNmb3JtJzogJ3JvdGF0ZSggJysgKCAtcm90YXRlRmluaXNoICkgKydkZWcgKScsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJ3RyYW5zZm9ybSc6ICdyb3RhdGUoICcrICggLXJvdGF0ZUZpbmlzaCApICsnZGVnICknXG4gICAgICAgICAgICAgICAgICAgICAgICB9ICk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIC8vX29iai5yZW1vdmVDbGFzcygncHV0dGVkJyk7XG5cbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmICggc2Nyb2xsUG9pbnQgPT0gMCApIHtcblxuXG4gICAgICAgICAgICAgICAgICAgICAgICBjdXJFbGVtLmNzcygge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICctd2Via2l0LXRyYW5zZm9ybSc6ICdyb3RhdGUoICcrICggLXJvdGF0ZVN0YXJ0ICkgKydkZWcgKScsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJ3RyYW5zZm9ybSc6ICdyb3RhdGUoICcrICggLXJvdGF0ZVN0YXJ0ICkgKydkZWcgKSdcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gKTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgLy9fb2JqLnJlbW92ZUNsYXNzKCdwdXR0ZWQnKTtcblxuXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIGN1ckVsZW0uY3NzKCB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJy13ZWJraXQtdHJhbnNmb3JtJzogJ3JvdGF0ZSggJysgKCAta29mUm90YXRlICkrJ2RlZyApJyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAndHJhbnNmb3JtJzogJ3JvdGF0ZSggJysgKCAta29mUm90YXRlICkgKydkZWcgKSdcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gKTtcblxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSApO1xuXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgX2luaXQgPSBmdW5jdGlvbiAoKSB7XG5cbiAgICAgICAgICAgICAgICBfb2JqWzBdLm9iaiA9IF9zZWxmO1xuICAgICAgICAgICAgICAgIF9hZGRFdmVudHMoKTtcbiAgICAgICAgICAgICAgICBfY2hlY2tHZXRJbldpbmRvdygpO1xuICAgICAgICAgICAgICAgIF9jaGVja1B1dEluV2luZG93KCk7XG5cbiAgICAgICAgICAgIH07XG5cbiAgICAgICAgX2luaXQoKTtcbiAgICB9O1xuXG4gICAgdmFyIENvbnRlbnRGdWxsSGVpZ2h0ID0gZnVuY3Rpb24gKCBvYmogKSB7XG5cbiAgICAgICAgdmFyIF9zZWxmID0gdGhpcyxcbiAgICAgICAgICAgIF9vYmogPSBvYmosXG4gICAgICAgICAgICBfd2luZG93ID0gJCh3aW5kb3cpLFxuICAgICAgICAgICAgX2hlYWRlciA9ICQoJy5zaXRlX19oZWFkZXInKTtcblxuICAgICAgICB2YXIgX2FkZEV2ZW50cyA9IGZ1bmN0aW9uICgpIHtcblxuICAgICAgICAgICAgICAgIF93aW5kb3cub24oIHtcbiAgICAgICAgICAgICAgICAgICAgcmVzaXplOiBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIF9zZXRIZWlnaHQoKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0gKTtcblxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIF9zZXRIZWlnaHQgPSBmdW5jdGlvbigpIHtcblxuICAgICAgICAgICAgICAgIHZhciBoZWFkZXJIZWlndGggPSBfaGVhZGVyLmhlaWdodCgpO1xuXG4gICAgICAgICAgICAgICAgX29iai5oZWlnaHQoIF93aW5kb3cuaGVpZ2h0KCkgLSBoZWFkZXJIZWlndGggKTtcbiAgICAgICAgICAgICAgICBfb2JqLmNzcygge1xuICAgICAgICAgICAgICAgICAgICAnbWluLWhlaWdodCc6IF9vYmouZmluZCgnPmRpdjpmaXJzdCcpLmhlaWdodCgpXG4gICAgICAgICAgICAgICAgfSApO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIF9pbml0ID0gZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgX29ialswXS5vYmogPSBfc2VsZjtcbiAgICAgICAgICAgICAgICBfYWRkRXZlbnRzKCk7XG4gICAgICAgICAgICAgICAgX3NldEhlaWdodCgpO1xuICAgICAgICAgICAgfTtcblxuICAgICAgICBfaW5pdCgpO1xuICAgIH07XG5cbiAgICB2YXIgUGxhbnNDaG9vc2VIZWlnaHQgPSBmdW5jdGlvbiAoIG9iaiApIHtcblxuICAgICAgICB2YXIgX3NlbGYgPSB0aGlzLFxuICAgICAgICAgICAgX29iaiA9IG9iaixcbiAgICAgICAgICAgIF93aW5kb3cgPSAkKHdpbmRvdyksXG4gICAgICAgICAgICBfY2FwdGlvbiA9IF9vYmouZmluZCgnLnBsYW5zX19saXN0X2NhcHRpb24nKSxcbiAgICAgICAgICAgIF9jb250ZW50ID0gX29iai5maW5kKCcucGxhbnNfX2xpc3Qtcm93Om5vdCgucGxhbnNfX2xpc3RfY2FwdGlvbiknKSxcbiAgICAgICAgICAgIF9jYXB0aW9uSGVpZ2h0cyA9IFtdLFxuICAgICAgICAgICAgX2NvbnRlbnRIZWlnaHRzID0gW107XG5cbiAgICAgICAgdmFyIF9hZGRFdmVudHMgPSBmdW5jdGlvbiAoKSB7XG5cbiAgICAgICAgICAgICAgICBfd2luZG93Lm9uKCB7XG4gICAgICAgICAgICAgICAgICAgIGxvYWQ6IGZ1bmN0aW9uKCkge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiggX3dpbmRvdy53aWR0aCgpID49IDEwMjQgKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBfc2V0SGVpZ2h0KCk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICByZXNpemU6IGZ1bmN0aW9uKCkge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiggX3dpbmRvdy53aWR0aCgpIDwgMTAyNCApIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9jYXB0aW9uLmNzcygge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBoZWlnaHQ6ICcnXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSApO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9jb250ZW50LmNzcygge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBoZWlnaHQ6ICcnXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSApO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgX3NldEhlaWdodCgpO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0gKTtcblxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIF9zZXRIZWlnaHQgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgICBfY2FwdGlvbkhlaWdodHMgPSBbXTtcbiAgICAgICAgICAgICAgICBfY29udGVudEhlaWdodHMgPSBbXTtcblxuICAgICAgICAgICAgICAgIF9jYXB0aW9uLmVhY2goIGZ1bmN0aW9uKCkge1xuXG4gICAgICAgICAgICAgICAgICAgIHZhciBoZWlnaHQgPSAkKHRoaXMpLmlubmVySGVpZ2h0KCk7XG5cbiAgICAgICAgICAgICAgICAgICAgX2NhcHRpb25IZWlnaHRzLnB1c2goIGhlaWdodCApO1xuXG4gICAgICAgICAgICAgICAgfSApO1xuXG4gICAgICAgICAgICAgICAgdmFyIG1heEhlaWdodENhcHRpb24gPSBNYXRoLm1heC5hcHBseShNYXRoLCBfY2FwdGlvbkhlaWdodHMpO1xuXG5cbiAgICAgICAgICAgICAgICBfY29udGVudC5lYWNoKCBmdW5jdGlvbigpIHtcblxuICAgICAgICAgICAgICAgICAgICB2YXIgaGVpZ2h0ID0gJCh0aGlzKS5pbm5lckhlaWdodCgpO1xuXG4gICAgICAgICAgICAgICAgICAgIF9jb250ZW50SGVpZ2h0cy5wdXNoKCBoZWlnaHQgKTtcblxuICAgICAgICAgICAgICAgIH0gKTtcblxuICAgICAgICAgICAgICAgIHZhciBtYXhIZWlnaHRDb250ZW50ID0gTWF0aC5tYXguYXBwbHkoTWF0aCwgX2NvbnRlbnRIZWlnaHRzKTtcblxuICAgICAgICAgICAgICAgIF9jYXB0aW9uLmlubmVySGVpZ2h0KCBtYXhIZWlnaHRDYXB0aW9uICk7XG4gICAgICAgICAgICAgICAgX2NvbnRlbnQuaW5uZXJIZWlnaHQoIG1heEhlaWdodENvbnRlbnQgKTtcblxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIF9pbml0ID0gZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgX29ialswXS5vYmogPSBfc2VsZjtcbiAgICAgICAgICAgICAgICBfYWRkRXZlbnRzKCk7XG4gICAgICAgICAgICB9O1xuXG4gICAgICAgIF9pbml0KCk7XG4gICAgfTtcblxufSApKCk7XG4iLCJcInVzZSBzdHJpY3RcIjtcbiggZnVuY3Rpb24oKSB7XG5cbiAgICAkKCBmdW5jdGlvbigpIHtcblxuICAgICAgICAkLmVhY2goICQoJy5jaG9vc2UtZGF0YScpLCBmdW5jdGlvbiAoKSB7XG5cbiAgICAgICAgICAgIG5ldyBDaG9vc2VEYXRhKCAkKHRoaXMpICk7XG5cbiAgICAgICAgfSApO1xuXG4gICAgICAgICQuZWFjaCggJCgnLm9yZGVyJyksIGZ1bmN0aW9uICgpIHtcblxuICAgICAgICAgICAgbmV3IFBhc3RlRGF0YSggJCh0aGlzKSApO1xuXG4gICAgICAgIH0gKTtcblxuICAgICAgICAkLmVhY2goICQoJy5wbGFucycpLCBmdW5jdGlvbiAoKSB7XG5cbiAgICAgICAgICAgIG5ldyBEYXRlUGxhbiggJCh0aGlzKSApO1xuXG4gICAgICAgIH0gKTtcblxuICAgIH0gKTtcblxuICAgIHZhciBDaG9vc2VEYXRhID0gZnVuY3Rpb24gKG9iaikge1xuXG4gICAgICAgIC8vcHJpdmF0ZSBwcm9wZXJ0aWVzXG4gICAgICAgIHZhciBfc2VsZiA9IHRoaXMsXG4gICAgICAgICAgICBfb2JqID0gb2JqLFxuICAgICAgICAgICAgX2l0ZW1zID0gX29iai5maW5kKCcuY2hvb3NlLWRhdGFfX2l0ZW1zJyksXG4gICAgICAgICAgICBfaW5wdXQgPSBfaXRlbXMuZmluZCgnaW5wdXQnKSxcbiAgICAgICAgICAgIF9yZWRpcmVjdEJ0biA9IF9vYmouZmluZCgnLmJ0bl9uZXh0JyksXG4gICAgICAgICAgICBfZGF0YVJhZGlvID0ge30sXG4gICAgICAgICAgICBfZGF0YUNoZWNrYm94ID0ge30sXG4gICAgICAgICAgICBfaWRJdGVtcyA9IHt9O1xuXG4gICAgICAgIC8vcHJpdmF0ZSBtZXRob2RzXG4gICAgICAgIHZhciBfYWRkRXZlbnRzID0gZnVuY3Rpb24gKCkge1xuXG4gICAgICAgICAgICAgICAgX2lucHV0Lm9uKCB7XG4gICAgICAgICAgICAgICAgICAgIGNsaWNrOiBmdW5jdGlvbigpIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgX2dldERhdGEoICQodGhpcykgKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIF93cml0ZUluU2Vzc2lvblN0b3JhZ2UoKTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgbG9jYWxTdG9yYWdlLnNldEl0ZW0oJ2lkSXRlbXMnLCBKU09OLnN0cmluZ2lmeShfaWRJdGVtcykpO1xuXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9ICk7XG5cbiAgICAgICAgICAgICAgICBfcmVkaXJlY3RCdG4ub24oIHtcbiAgICAgICAgICAgICAgICAgICAgY2xpY2s6IGZ1bmN0aW9uKCkge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgY3VySXRlbSA9ICQodGhpcyksXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZGF0YVNyYyA9IGN1ckl0ZW0uZGF0YSgnc3JjJyk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIF93cml0ZUFsbElkKCk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIHdpbmRvdy5sb2NhdGlvbi5ocmVmID0gZGF0YVNyYztcblxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9ICk7XG5cbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBfZ2V0RGF0YSA9IGZ1bmN0aW9uKCBlbGVtICkge1xuXG4gICAgICAgICAgICAgICAgdmFyIGN1ckl0ZW0gPSBlbGVtO1xuXG4gICAgICAgICAgICAgICAgaWYoIGN1ckl0ZW0uYXR0cigndHlwZScpID09PSAncmFkaW8nICkge1xuXG4gICAgICAgICAgICAgICAgICAgIGlmKCBjdXJJdGVtLnBhcmVudHMoJy5wbGFucycpLmxlbmd0aCApIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgX2RhdGFSYWRpby5yYXRlUGxhbiA9IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZXNzaW9uVHlwZTogY3VySXRlbS5kYXRhKCdyYXRlJyksXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWU6IGN1ckl0ZW0uYXR0cigndmFsdWUnKVxuICAgICAgICAgICAgICAgICAgICAgICAgfTtcblxuXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIF9kYXRhUmFkaW9bY3VySXRlbS5hdHRyKCduYW1lJyldID0gY3VySXRlbS5hdHRyKCd2YWx1ZScpO1xuXG4gICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICBfaWRJdGVtc1tjdXJJdGVtLmF0dHIoJ25hbWUnKV0gPSBjdXJJdGVtLmF0dHIoJ2lkJyk7XG5cbiAgICAgICAgICAgICAgICB9IGVsc2UgaWYoIGN1ckl0ZW0uYXR0cigndHlwZScpID09PSAnY2hlY2tib3gnICkge1xuXG4gICAgICAgICAgICAgICAgICAgIGlmIChjdXJJdGVtLmlzKFwiOmNoZWNrZWRcIikpIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgX2RhdGFDaGVja2JveFtjdXJJdGVtLmF0dHIoJ25hbWUnKV0gPSBjdXJJdGVtLmF0dHIoJ3ZhbHVlJyk7XG4gICAgICAgICAgICAgICAgICAgICAgICBfaWRJdGVtc1tjdXJJdGVtLmF0dHIoJ25hbWUnKV0gPSBjdXJJdGVtLmF0dHIoJ2lkJyk7XG5cbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgZGVsZXRlIF9kYXRhQ2hlY2tib3hbY3VySXRlbS5hdHRyKCduYW1lJyldO1xuICAgICAgICAgICAgICAgICAgICAgICAgZGVsZXRlIF9pZEl0ZW1zW2N1ckl0ZW0uYXR0cignbmFtZScpXTtcblxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgX3NldENoZWNrZWROZWVkSW5wdXQgPSBmdW5jdGlvbigpIHtcblxuICAgICAgICAgICAgICAgIGlmKCBsb2NhbFN0b3JhZ2UuaWRJdGVtcyAhPSB1bmRlZmluZWQgKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgX2lucHV0LmVhY2goIGZ1bmN0aW9uKCkge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgY3VySXRlbSA9ICQodGhpcyk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIGlmKCBjdXJJdGVtLmF0dHIoJ3R5cGUnKSA9PT0gJ2NoZWNrYm94JyApIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGN1ckl0ZW0ucHJvcCgnY2hlY2tlZCcsIGZhbHNlICk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICB9ICk7XG5cbiAgICAgICAgICAgICAgICAgICAgdmFyIGFsbElkID0gSlNPTi5wYXJzZSggbG9jYWxTdG9yYWdlLmlkSXRlbXMgKTtcblxuICAgICAgICAgICAgICAgICAgICBmb3IoIHZhciBrZXkgaW4gYWxsSWQgICkge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgaXRlbSA9IGFsbElkWyBrZXkgXTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgX2lucHV0LmZpbHRlcignIycrIGl0ZW0gKycnKS5wcm9wKCdjaGVja2VkJywgdHJ1ZSApO1xuXG4gICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIF93cml0ZUFsbElkID0gZnVuY3Rpb24oKSB7XG5cbiAgICAgICAgICAgICAgICBfaW5wdXQuZWFjaCggZnVuY3Rpb24oKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgdmFyIGN1ckl0ZW0gPSAkKHRoaXMpO1xuXG4gICAgICAgICAgICAgICAgICAgIGlmKCBjdXJJdGVtLmlzKFwiOmNoZWNrZWRcIikgKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIGlmKCBjdXJJdGVtLmF0dHIoJ3R5cGUnKSA9PT0gJ3JhZGlvJyApIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9pZEl0ZW1zW2N1ckl0ZW0uYXR0cignbmFtZScpXSA9IGN1ckl0ZW0uYXR0cignaWQnKTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmKCBjdXJJdGVtLmF0dHIoJ3R5cGUnKSA9PT0gJ2NoZWNrYm94JyApIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmKCBjdXJJdGVtLmlzKFwiOmNoZWNrZWRcIikgKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgX2lkSXRlbXNbY3VySXRlbS5hdHRyKCduYW1lJyldID0gY3VySXRlbS5hdHRyKCdpZCcpO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWxldGUgX2lkSXRlbXNbY3VySXRlbS5hdHRyKCduYW1lJyldO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuXG5cbiAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICB9ICk7XG5cbiAgICAgICAgICAgICAgICBsb2NhbFN0b3JhZ2Uuc2V0SXRlbSgnaWRJdGVtcycsIEpTT04uc3RyaW5naWZ5KF9pZEl0ZW1zKSk7XG5cbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBfd3JpdGVEYXRhSW5PYmpBZnRlckxvYWQgPSBmdW5jdGlvbigpIHtcblxuICAgICAgICAgICAgICAgIF9pbnB1dC5lYWNoKCBmdW5jdGlvbigpIHtcblxuICAgICAgICAgICAgICAgICAgICB2YXIgY3VySXRlbSA9ICQodGhpcyk7XG5cbiAgICAgICAgICAgICAgICAgICAgaWYoIGN1ckl0ZW0uaXMoXCI6Y2hlY2tlZFwiKSApIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgaWYoIGN1ckl0ZW0uYXR0cigndHlwZScpID09PSAncmFkaW8nICkge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYoIGN1ckl0ZW0ucGFyZW50cygnLnBsYW5zJykubGVuZ3RoICkge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9kYXRhUmFkaW8ucmF0ZVBsYW4gPSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZXNzaW9uVHlwZTogY3VySXRlbS5kYXRhKCdyYXRlJyksXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZTogY3VySXRlbS5hdHRyKCd2YWx1ZScpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9kYXRhUmFkaW9bY3VySXRlbS5hdHRyKCduYW1lJyldID0gY3VySXRlbS5hdHRyKCd2YWx1ZScpO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYoIGN1ckl0ZW0uYXR0cigndHlwZScpID09PSAnY2hlY2tib3gnICkge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYoIGN1ckl0ZW0uaXMoXCI6Y2hlY2tlZFwiKSApIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfZGF0YUNoZWNrYm94W2N1ckl0ZW0uYXR0cignbmFtZScpXSA9IGN1ckl0ZW0uYXR0cigndmFsdWUnKTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVsZXRlIF9kYXRhQ2hlY2tib3hbY3VySXRlbS5hdHRyKCduYW1lJyldO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuXG5cbiAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICB9ICk7XG5cbiAgICAgICAgICAgICAgICBfd3JpdGVJblNlc3Npb25TdG9yYWdlKCk7XG5cbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBfd3JpdGVJblNlc3Npb25TdG9yYWdlID0gZnVuY3Rpb24oKSB7XG5cbiAgICAgICAgICAgICAgICBsb2NhbFN0b3JhZ2Uuc2V0SXRlbSgncmFkaW9DaG9vc2UnLCBKU09OLnN0cmluZ2lmeShfZGF0YVJhZGlvKSk7XG4gICAgICAgICAgICAgICAgbG9jYWxTdG9yYWdlLnNldEl0ZW0oJ2NoZWNrYm94Q2hvb3NlJywgSlNPTi5zdHJpbmdpZnkoX2RhdGFDaGVja2JveCkpO1xuXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgX2luaXQgPSBmdW5jdGlvbiAoKSB7XG5cbiAgICAgICAgICAgICAgICBfb2JqWzBdLm9iaiA9IF9zZWxmO1xuICAgICAgICAgICAgICAgIF9hZGRFdmVudHMoKTtcbiAgICAgICAgICAgICAgICBfc2V0Q2hlY2tlZE5lZWRJbnB1dCgpO1xuICAgICAgICAgICAgICAgIF93cml0ZURhdGFJbk9iakFmdGVyTG9hZCgpO1xuICAgICAgICAgICAgfTtcblxuICAgICAgICBfaW5pdCgpO1xuICAgIH07XG5cbiAgICB2YXIgUGFzdGVEYXRhID0gZnVuY3Rpb24gKG9iaikge1xuXG4gICAgICAgIC8vcHJpdmF0ZSBwcm9wZXJ0aWVzXG4gICAgICAgIHZhciBfc2VsZiA9IHRoaXMsXG4gICAgICAgICAgICBfb2JqID0gb2JqLFxuICAgICAgICAgICAgX2Nob3NlbkRhdGEgPSBfb2JqLmZpbmQoJy5vcmRlcl9fY2hvc2VuLWRhdGEgc3BhbicpLFxuICAgICAgICAgICAgX2RhdGFSYWRpbyxcbiAgICAgICAgICAgIF9kYXRhQ2hlY2tib3gsXG4gICAgICAgICAgICBfaW5wdXQgPSBfb2JqLmZpbmQoJ2lucHV0I2lucHV0XzFfNScpLFxuICAgICAgICAgICAgX2FyciA9IFtdLFxuICAgICAgICAgICAgX3N0ciA9ICcnO1xuXG4gICAgICAgIC8vcHJpdmF0ZSBtZXRob2RzXG4gICAgICAgIHZhciBfYWRkRXZlbnRzID0gZnVuY3Rpb24gKCkge1xuXG5cblxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIF93cml0ZUluQmxvY2sgPSBmdW5jdGlvbigpIHtcblxuICAgICAgICAgICAgICAgIHZhciBkaXZSYXRlID0gJycsXG4gICAgICAgICAgICAgICAgICAgIG51bSA9ICcnLFxuICAgICAgICAgICAgICAgICAgICBhcnIgPSBbXTtcblxuICAgICAgICAgICAgICAgIGZvciggdmFyIGtleSBpbiBfZGF0YVJhZGlvICApIHtcblxuICAgICAgICAgICAgICAgICAgICB2YXIgaXRlbSA9IF9kYXRhUmFkaW9bIGtleSBdO1xuXG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgaWYoIF9kYXRhUmFkaW8ucmF0ZVBsYW4gIT0gdW5kZWZpbmVkICkge1xuXG4gICAgICAgICAgICAgICAgICAgICQuZWFjaCggX2RhdGFSYWRpby5yYXRlUGxhbiwgZnVuY3Rpb24oKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciB2YWx1ZSA9IF9kYXRhUmFkaW8ucmF0ZVBsYW4udmFsdWUuc3BsaXQoJyAnKTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgaWYoIF9kYXRhUmFkaW8ucmF0ZVBsYW4uc2Vzc2lvblR5cGUgPT09ICdzZXNzaW9uIHByaWNpbmcnICkge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZGl2UmF0ZSA9ICc8c3Bhbj4nKyBfZGF0YVJhZGlvLnJhdGVQbGFuLnNlc3Npb25UeXBlICsnICgnKyB2YWx1ZVswXSArJyBzZXNzaW9ucyk8L3NwYW4+JztcblxuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmKCBfZGF0YVJhZGlvLnJhdGVQbGFuLnNlc3Npb25UeXBlID09PSAnbWludXRlIHByaWNpbmcnICkge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIG1pbnV0ZXMgPSB2YWx1ZVswXS5yZXBsYWNlKC9bXjAtOV0rL2csJycpO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYoIG1pbnV0ZXMgPiAxMDAwMDAgKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbWludXRlcyA9IG1pbnV0ZXMvMTAwMDAwMCArICdNJ1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZGl2UmF0ZSA9ICc8c3Bhbj4nKyBfZGF0YVJhZGlvLnJhdGVQbGFuLnNlc3Npb25UeXBlICsnICgnKyBtaW51dGVzICsnIG1pbnV0ZXMgKCcgKyB2YWx1ZVsyXSArICcvbWludXRlKTwvc3Bhbj4nO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICB9XG5cblxuICAgICAgICAgICAgICAgICAgICB9ICk7XG5cbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBmb3IoIHZhciBrZXkxIGluIF9kYXRhQ2hlY2tib3ggICkge1xuXG4gICAgICAgICAgICAgICAgICAgIGFyci5wdXNoKGtleTEpXG5cbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBpZiggYXJyLmxlbmd0aCA+IDAgKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgaWYoIGFyci5sZW5ndGggPT0gMSApIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgbnVtID0gJysgJyArIGFyci5sZW5ndGggKyAnIHNlcnZpY2UnO1xuXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIG51bSA9ICcrICcgKyBhcnIubGVuZ3RoICsgJyBzZXJ2aWNlJztcblxuICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBfY2hvc2VuRGF0YS5odG1sKCdZb3UgY2hvc2UgJyArIGRpdlJhdGUgKyAnLCAnICsgaXRlbSArICcgJyArIG51bSArICcpLicpO1xuXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgX3dyaXRlSW5IaWRkZW4gPSBmdW5jdGlvbigpIHtcblxuICAgICAgICAgICAgICAgIF9zdHIgPSAnJztcblxuICAgICAgICAgICAgICAgIGZvciggdmFyIGtleSBpbiBfZGF0YVJhZGlvICApIHtcblxuICAgICAgICAgICAgICAgICAgICB2YXIgaXRlbSA9IF9kYXRhUmFkaW9bIGtleSBdO1xuXG4gICAgICAgICAgICAgICAgICAgIGlmKCB0eXBlb2YgaXRlbSA9PT0gJ3N0cmluZycgKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIF9zdHIgKz0gJycrIGl0ZW0gKyc7ICdcblxuICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYoIHR5cGVvZiBpdGVtID09PSAnb2JqZWN0JyApIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgZm9yKCB2YXIga2V5MSBpbiBpdGVtICApIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBpdGVtMSA9IGl0ZW1bIGtleTEgXTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9zdHIgKz0gJycrIGl0ZW0xICsnOyAnXG5cbiAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBmb3IoIHZhciBrZXkzIGluIF9kYXRhQ2hlY2tib3ggICkge1xuXG4gICAgICAgICAgICAgICAgICAgIHZhciBpdGVtMyA9IF9kYXRhQ2hlY2tib3hbIGtleTMgXTtcblxuICAgICAgICAgICAgICAgICAgICBfc3RyICs9ICcnKyBpdGVtMyArJzsgJ1xuXG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgX2lucHV0LnZhbCggX3N0ciApO1xuXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgX2dldFNlc3Npb25EYXRhID0gZnVuY3Rpb24oKSB7XG5cbiAgICAgICAgICAgICAgICBpZiggbG9jYWxTdG9yYWdlLnJhZGlvQ2hvb3NlICE9IHVuZGVmaW5lZCApIHtcblxuICAgICAgICAgICAgICAgICAgICBfZGF0YVJhZGlvID0gSlNPTi5wYXJzZSggbG9jYWxTdG9yYWdlLnJhZGlvQ2hvb3NlICk7XG4gICAgICAgICAgICAgICAgICAgIF9kYXRhQ2hlY2tib3ggPSBKU09OLnBhcnNlKCBsb2NhbFN0b3JhZ2UuY2hlY2tib3hDaG9vc2UgKTtcblxuICAgICAgICAgICAgICAgICAgICBfd3JpdGVJbkhpZGRlbigpO1xuICAgICAgICAgICAgICAgICAgICBfd3JpdGVJbkJsb2NrKCk7XG5cbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuXG4gICAgICAgICAgICAgICAgICAgIHdpbmRvdy5sb2NhdGlvbi5ocmVmID0gJCgnYm9keScpLmRhdGEoJ3NyYycpO1xuXG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgX2luaXQgPSBmdW5jdGlvbiAoKSB7XG5cbiAgICAgICAgICAgICAgICBfb2JqWzBdLm9iaiA9IF9zZWxmO1xuICAgICAgICAgICAgICAgIF9hZGRFdmVudHMoKTtcbiAgICAgICAgICAgICAgICBfZ2V0U2Vzc2lvbkRhdGEoKTtcbiAgICAgICAgICAgIH07XG5cbiAgICAgICAgX2luaXQoKTtcbiAgICB9O1xuXG4gICAgdmFyIERhdGVQbGFuID0gZnVuY3Rpb24gKG9iaikge1xuXG4gICAgICAgIC8vcHJpdmF0ZSBwcm9wZXJ0aWVzXG4gICAgICAgIHZhciBfc2VsZiA9IHRoaXMsXG4gICAgICAgICAgICBfb2JqID0gb2JqLFxuICAgICAgICAgICAgX2l0ZW1zID0gX29iai5maW5kKCcucGxhbnNfX2l0ZW0nKSxcbiAgICAgICAgICAgIF9yYWRpbyA9IF9vYmouZmluZCgnaW5wdXRbdHlwZT1cInJhZGlvXCJdJyksXG4gICAgICAgICAgICBfd2luZG93ID0gJCh3aW5kb3cpO1xuXG4gICAgICAgIC8vcHJpdmF0ZSBtZXRob2RzXG4gICAgICAgIHZhciBfYWRkRXZlbnRzID0gZnVuY3Rpb24gKCkge1xuXG4gICAgICAgICAgICAgICAgX3dpbmRvdy5vbigge1xuICAgICAgICAgICAgICAgICAgICBsb2FkOiBmdW5jdGlvbigpIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgX3NldEFjdGl2ZUNsYXNzKCk7XG5cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0gKTtcblxuICAgICAgICAgICAgICAgIF9yYWRpby5vbigge1xuICAgICAgICAgICAgICAgICAgICBjaGFuZ2U6IGZ1bmN0aW9uKCkge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgY3VySXRlbSA9ICQodGhpcyksXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcGFyZW50ID0gY3VySXRlbS5wYXJlbnRzKCcucGxhbnNfX2l0ZW0nKTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgaWYoICEoIHBhcmVudC5oYXNDbGFzcygnYWN0aXZlJykgKSApIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9pdGVtcy5yZW1vdmVDbGFzcygnYWN0aXZlJyk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcGFyZW50LmFkZENsYXNzKCdhY3RpdmUnKTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9ICk7XG5cbiAgICAgICAgICAgICAgICBfaXRlbXMub24oIHtcbiAgICAgICAgICAgICAgICAgICAgY2xpY2s6IGZ1bmN0aW9uKCkge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgY3VySXRlbSA9ICQodGhpcyksXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZmlyc3RSYWRpbyA9IGN1ckl0ZW0uZmluZCgnaW5wdXRbdHlwZT1cInJhZGlvXCJdOmZpcnN0Jyk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIGlmKCAhKCBjdXJJdGVtLmhhc0NsYXNzKCdhY3RpdmUnKSApICkge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgX2l0ZW1zLnJlbW92ZUNsYXNzKCdhY3RpdmUnKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjdXJJdGVtLmFkZENsYXNzKCdhY3RpdmUnKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmaXJzdFJhZGlvLnRyaWdnZXIoJ2NsaWNrJyk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSApO1xuXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgX3NldEFjdGl2ZUNsYXNzID0gZnVuY3Rpb24oKSB7XG5cbiAgICAgICAgICAgICAgICB2YXIgYWN0aXZlUmFkaW8gPSBfcmFkaW8uZmlsdGVyKCc6Y2hlY2tlZCcpLFxuICAgICAgICAgICAgICAgICAgICBwYXJlbnQgPSBhY3RpdmVSYWRpby5wYXJlbnRzKCcucGxhbnNfX2l0ZW0nKTtcblxuICAgICAgICAgICAgICAgICAgICBwYXJlbnQuYWRkQ2xhc3MoJ2FjdGl2ZScpO1xuXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgX2luaXQgPSBmdW5jdGlvbiAoKSB7XG5cbiAgICAgICAgICAgICAgICBfb2JqWzBdLm9iaiA9IF9zZWxmO1xuICAgICAgICAgICAgICAgIF9hZGRFdmVudHMoKTtcbiAgICAgICAgICAgIH07XG5cbiAgICAgICAgX2luaXQoKTtcbiAgICB9O1xuXG59ICkoKTtcbiJdLCJzb3VyY2VSb290IjoiL3NvdXJjZS8ifQ==
